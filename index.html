<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COPILOTO PRO ‚Äî Intelig√™ncia Imobili√°ria</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg:#f8fafc; --panel:#ffffff; --text:#0f172a; --muted:#64748b; --border:#e2e8f0;
    --primary:#2563eb; --primary-dark:#1d4ed8; --accent:#f59e0b; --radius:12px;
    --success:#16a34a;
  }

  *{box-sizing:border-box; font-family: 'Inter', system-ui, sans-serif;}
  body{ margin:0; background: var(--bg); color: var(--text); }

  /* TOPBAR ECON√îMICA */
  .eco-header { background: #0f172a; color: #fff; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; font-size: 13px; }
  .eco-stats { display: flex; gap: 20px; }
  .eco-item span { color: var(--accent); font-weight: 800; margin-left: 5px; }
  #live-clock { font-family: monospace; font-size: 15px; color: #fff; border-left: 1px solid #334155; padding-left: 20px; }

  header{ position:sticky; top:0; z-index:50; background:rgba(255,255,255,.9); backdrop-filter: blur(10px); border-bottom:1px solid var(--border); padding:10px 20px; }
  .topbar{ max-width:1400px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
  
  main{ max-width:1400px; margin:20px auto; padding:0 20px; display:grid; grid-template-columns: 350px 1fr 400px; gap:20px; }

  .card{ background:white; border-radius:var(--radius); border:1px solid var(--border); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); overflow:hidden; margin-bottom:15px;}
  .card-head{ padding:12px 15px; border-bottom:1px solid var(--border); background:#f8fafc; font-weight:800; font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing: 1px; }
  .card-body{ padding:15px; }

  /* LISTA DE INFOS COMPLETAS */
  .info-block { background: #f1f5f9; border-radius: 8px; padding: 12px; margin-top: 10px; }
  .info-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid #e2e8f0; font-size: 13px; }
  .info-item:last-child { border: none; }

  /* CALCULADORA DE PROCRASTINA√á√ÉO */
  .proc-calc { background: #fff7ed; border: 1px dashed #fdba74; padding: 15px; border-radius: 8px; margin-top: 15px; }
  .loss-value { color: #dc2626; font-size: 20px; font-weight: 800; }

  /* BOT√ïES */
  button, .btn-link{ padding:10px 20px; border-radius:8px; border:none; cursor:pointer; font-weight:700; transition: 0.2s; text-decoration: none; display: inline-block; text-align: center; }
  .btn-primary{ background: var(--primary); color:white; }
  .btn-success{ background: var(--success); color:white; width:100%; margin-top:15px; font-size:14px; box-shadow: 0 4px 12px rgba(22,163,74,0.2); }
  .btn-success:hover{ background: #15803d; transform: translateY(-2px); }
  .btn-export{ background: #000; color: #fff; width:100%; margin:20px 0; padding:18px; border: 2px solid var(--primary); font-size:16px; }

  textarea { width:100%; padding:15px; border:1px solid var(--border); border-radius:8px; font-size:16px; background: #fff; }

  #adminDrawer{ position:fixed; inset:0; display:none; z-index:100; }
  #adminDrawer.show{ display:flex; }
  .drawer-content{ width:min(800px, 95%); background:white; margin-left:auto; height:100%; box-shadow:-20px 0 50px rgba(0,0,0,0.2); overflow-y:auto; padding:30px; }

  @media (max-width: 1100px){ main{ grid-template-columns: 1fr; } }
</style>
</head>
<body onload="startTime()">

<div class="eco-header">
  <div class="eco-stats">
    <div class="eco-item">SELIC: <span id="val-selic">11.75%</span></div>
    <div class="eco-item">IPCA: <span id="val-ipca">4.62%</span></div>
    <div class="eco-item">IGP-M: <span id="val-igpm">0.89%</span></div>
  </div>
  <div id="live-clock">00:00:00</div>
</div>

<header>
  <div class="topbar">
    <div><strong>COPILOTO PRO</strong> <span id="userBadge" style="font-size:10px; background:#eee; padding:2px 6px; border-radius:4px;"></span></div>
    <div id="userTools" style="display:none; gap:10px;">
      <button class="btn-outline" id="btnAdmin" onclick="openAdmin()">‚öôÔ∏è Configura√ß√µes</button>
      <button onclick="location.reload()">Sair</button>
    </div>
  </div>
</header>

<div id="loginArea" style="position:fixed; inset:0; background:var(--bg); z-index:200; display:flex; align-items:center; justify-content:center;">
  <div class="card" style="width:350px; padding:30px;">
    <h2 style="margin-top:0">Acesso Portal</h2>
    <input id="lUser" type="text" placeholder="Usu√°rio" value="edson">
    <input id="lPass" type="password" placeholder="Senha" value="2026">
    <button class="btn-primary" onclick="initApp()" style="width:100%">Entrar no Sistema</button>
  </div>
</div>

<main id="appMain" style="opacity:0.1; pointer-events:none;">
  <aside>
    <div class="card">
      <div class="card-head">Ficha do Im√≥vel</div>
      <div class="card-body">
        <h2 id="view-name" style="color:var(--primary); margin:0 0 10px 0;">Aguardando...</h2>
        <div id="view-details" class="info-block">
          <p style="font-size:12px; color:var(--muted)">Mencione o nome de um produto para carregar os dados t√©cnicos.</p>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-head">Custo da Procrastina√ß√£o</div>
      <div class="card-body proc-calc">
        <p style="margin:0; font-size:12px; font-weight:700;">SE ESPERAR 12 MESES:</p>
        <div class="loss-value" id="view-loss">R$ 0,00</div>
        <p style="font-size:11px; margin-top:5px; color:#9a3412;">*Baseado na valoriza√ß√£o m√©dia e reajustes.</p>
      </div>
    </div>

    <a href="https://lucianabogo333-spec.github.io/formalizacao-proposta/" target="_blank" class="btn-link btn-success">
      üìù FORMALIZA√á√ÉO DE PROPOSTA
    </a>
  </aside>

  <section>
    <div class="card">
      <div class="card-head">Escuta Estrat√©gica</div>
      <div class="card-body">
        <textarea id="mainInput" placeholder="O que o cliente est√° dizendo?" style="min-height:350px;"></textarea>
        <button class="btn-primary" id="micBtn" onclick="toggleMic()" style="width:100%; margin-top:10px; height:50px;">üéôÔ∏è Capturar Voz do Cliente</button>
      </div>
    </div>
  </section>

  <aside>
    <div class="card"><div class="card-head">Resposta Sugerida</div><div class="card-body">
      <div id="res-box" style="font-size:15px; line-height:1.5; font-weight:500;">Aguardando detec√ß√£o de obje√ß√µes...</div>
    </div></div>
    <div class="card"><div class="card-head">Gr√°fico de Performance</div><div class="card-body"><canvas id="mainChart"></canvas></div></div>
  </aside>
</main>

<div id="adminDrawer">
  <div style="flex:1; background:rgba(0,0,0,0.6)" onclick="closeAdmin()"></div>
  <div class="drawer-content">
    <h2>Gest√£o do Sistema</h2>
    <button class="btn-export" onclick="copyFullCode()">üíæ COPIAR C√ìDIGO ATUALIZADO (GITHUB)</button>
    <hr>
    <h3>üì¶ Gerenciar Produtos</h3>
    <input id="fName" placeholder="Nome Comercial">
    <input id="fKeys" placeholder="Chaves (Ex: cedros, b√∫falo)">
    <input id="fVal" type="number" placeholder="Valor do Lote (R$)">
    <input id="fRate" type="number" placeholder="Valoriza√ß√£o Anual %">
    <textarea id="fInfos" placeholder="Infos t√©cnicas (uma por linha)"></textarea>
    <button class="btn-primary" onclick="addItem('products')">Salvar Produto</button>
    <div id="list-products" style="margin-top:20px"></div>
  </div>
</div>

<script id="databaseScript">
  let base = {
    indicators: { selic: "11.75%", ipca: "4.62%", igpm: "0.89%" },
    users: [{login:"edson", pass:"2026", role:"admin"}],
    products: [
      { name: "CEDROS JARDINS", keys: ["cedros", "b√∫falo"], baseVal: 150000, rate: 18, info: ["Metragem: 200m¬≤ a 450m¬≤", "Status: Em Obras", "Lazer: Completo Premium"] }
    ],
    objections: [
      { keys: ["caro", "pre√ßo"], a: "Entendo. O senhor avalia o pre√ßo hoje ou o lucro na entrega?", b: "Lotes vizinhos j√° custam 30% mais.", c: "O metro quadrado aqui √© o menor da regi√£o no pr√©-lan√ßamento." }
    ]
  };
</script>

<script>
let chart;

function startTime() {
  const today = new Date();
  document.getElementById('live-clock').innerHTML = today.toLocaleTimeString('pt-BR');
  setTimeout(startTime, 1000);
}

function initApp() {
  const u = document.getElementById("lUser").value;
  const p = document.getElementById("lPass").value;
  const user = base.users.find(x => x.login === u && x.pass === p);
  if(user) {
    document.getElementById("loginArea").style.display = "none";
    document.getElementById("appMain").style.opacity = "1";
    document.getElementById("appMain").style.pointerEvents = "all";
    document.getElementById("userTools").style.display = "flex";
    document.getElementById("userBadge").innerText = user.role.toUpperCase();
    initChart();
    renderLists();
  }
}

document.getElementById("mainInput").addEventListener("input", function() {
  const text = this.value.toLowerCase();
  const p = base.products.find(item => item.keys.some(k => text.includes(k.trim().toLowerCase())));
  if(p) {
    document.getElementById("view-name").innerText = p.name;
    let infoHtml = p.info.map(i => `<div class="info-item"><span>${i}</span></div>`).join("");
    infoHtml += `<div class="info-item"><strong>Valoriza√ß√£o:</strong> <span>${p.rate}% a.a.</span></div>`;
    infoHtml += `<div class="info-item"><strong>Valor Hoje:</strong> <span>R$ ${p.baseVal.toLocaleString()}</span></div>`;
    document.getElementById("view-details").innerHTML = infoHtml;
    const perda = p.baseVal * (p.rate / 100);
    document.getElementById("view-loss").innerText = `R$ ${perda.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
    updateChart(p.baseVal, p.rate);
  }
  const o = base.objections.find(item => item.keys.some(k => text.includes(k.trim().toLowerCase())));
  if(o) {
    document.getElementById("res-box").innerHTML = `
      <p>üü¢ <strong>Leve:</strong> ${o.a}</p>
      <p>üü° <strong>Forte:</strong> ${o.b}</p>
      <p>üî¥ <strong>Fechamento:</strong> ${o.c}</p>
    `;
  }
});

function initChart() {
  const ctx = document.getElementById('mainChart').getContext('2d');
  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Hoje', 'Ano 1', 'Ano 2', 'Ano 3'],
      datasets: [{ label: 'Valoriza√ß√£o', data: [100, 118, 140, 165], borderColor: '#2563eb', tension: 0.4, fill: true, backgroundColor: 'rgba(37,99,235,0.1)' }]
    },
    options: { plugins: { legend: { display: false } } }
  });
}

function updateChart(baseVal, rate) {
  let v = baseVal;
  let dataVal = [v];
  for(let i=1; i<=3; i++) { v *= (1+(rate/100)); dataVal.push(Math.round(v)); }
  chart.data.datasets[0].data = dataVal;
  chart.update();
}

function addItem(type) {
  if(type === 'products') {
    base.products.push({
      name: document.getElementById("fName").value.toUpperCase(),
      keys: document.getElementById("fKeys").value.split(",").map(k => k.trim()),
      baseVal: Number(document.getElementById("fVal").value),
      rate: Number(document.getElementById("fRate").value),
      info: document.getElementById("fInfos").value.split("\n")
    });
  }
  renderLists();
  alert("Salvo!");
}

function renderLists() {
  document.getElementById("list-products").innerHTML = base.products.map(p => `<div style="padding:8px; border-bottom:1px solid #eee;">${p.name} - R$ ${p.baseVal}</div>`).join("");
}

function copyFullCode() {
  const scriptDb = document.getElementById("databaseScript");
  scriptDb.innerHTML = `\n  let base = ${JSON.stringify(base, null, 2)};\n`;
  const code = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
  navigator.clipboard.writeText(code);
  alert("C√ìDIGO COPIADO!");
}

function openAdmin() { document.getElementById("adminDrawer").classList.add("show"); }
function closeAdmin() { document.getElementById("adminDrawer").classList.remove("show"); }

let rec;
if(window.webkitSpeechRecognition) {
  rec = new webkitSpeechRecognition();
  rec.lang = 'pt-BR'; rec.continuous = true;
  rec.onresult = (e) => {
    document.getElementById("mainInput").value += " " + e.results[e.results.length-1][0].transcript;
    document.getElementById("mainInput").dispatchEvent(new Event('input'));
  };
}
function toggleMic() { 
  const b = document.getElementById("micBtn");
  if(b.innerText.includes("Capturar")) { rec.start(); b.innerText = "üõë PARAR ESCUTA"; b.style.background = "red"; }
  else { rec.stop(); b.innerText = "üéôÔ∏è Capturar Voz do Cliente"; b.style.background = "var(--primary)"; }
}
</script>
</body>
</html>
