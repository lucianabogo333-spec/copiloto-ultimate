<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ELITE SINOP V22 - FULL</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --primary: #3b82f6; --good: #10b981; --bad: #ef4444; --text: #f8fafc; --border: #334155; --gold: #fcc201; }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; outline: none; }
        body { margin: 0; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        header { background: var(--card); padding: 12px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; gap: 5px; }
        .idx-container { display: flex; gap: 5px; overflow-x: auto; white-space: nowrap; flex: 1; }
        .index-tag { background: #000; padding: 4px 8px; border-radius: 6px; font-size: 10px; border: 1px solid var(--gold); color: var(--gold); font-weight: bold; }

        main { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; padding-bottom: 150px; }
        .card { background: var(--card); border-radius: 16px; padding: 18px; border: 1px solid var(--border); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        
        textarea, input { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: #000; color: #fff; margin-bottom: 10px; font-size: 14px; }
        .btn { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; }
        .btn-primary { background: var(--primary); } .btn-good { background: var(--good); } .btn-bad { background: var(--bad); }

        .calc-box { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--good); padding: 12px; border-radius: 10px; margin-top: 10px; font-size: 13px; }
        .footer { position: fixed; bottom: 0; width: 100%; background: var(--card); padding: 10px; border-top: 1px solid var(--border); display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        
        #adminPanel, #propPanel, #docPanel { position: fixed; inset: 0; background: var(--bg); z-index: 1500; display: none; padding: 20px; overflow-y: auto; }
        .overlay { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .q-box { margin-top: 10px; padding: 12px; border-radius: 12px; font-size: 13px; background: rgba(255,255,255,0.05); border-left: 4px solid var(--primary); }
    </style>
</head>
<body>

<div id="loginOverlay" class="overlay">
    <div class="card" style="width: 100%; max-width: 320px; text-align: center;">
        <h2 style="color:var(--primary)">Elite Sinop v22</h2>
        <input type="text" id="userLogin" placeholder="Usu√°rio">
        <input type="password" id="passLogin" placeholder="Senha">
        <button onclick="fazerLogin()" class="btn btn-primary" style="width:100%">ACESSAR SISTEMA</button>
    </div>
</div>

<header>
    <div class="idx-container" id="indicesTopo">Carregando √≠ndices oficiais...</div>
    <button id="btnAdmin" onclick="abrir('adminPanel')" style="display:none; background:none; border:none; font-size:20px;">‚öôÔ∏è</button>
</header>

<div id="propPanel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
        <h2>Formalizar Proposta</h2>
        <button onclick="fechar('propPanel')" class="btn btn-bad">X</button>
    </div>
    <div class="card">
        <input type="text" id="f_cliente" placeholder="NOME DO CLIENTE">
        <input type="text" id="f_cpf" placeholder="CPF">
        <input type="text" id="f_lote" placeholder="LOTEAMENTO / QUADRA / LOTE">
        <input type="text" id="f_entrada" placeholder="ENTRADA E VENCIMENTO">
        <input type="text" id="f_parc" placeholder="PARCELAMENTO E VENCIMENTO">
        <input type="text" id="f_contato" placeholder="CONTATO CLIENTE">
        <textarea id="f_ref" placeholder="3 REFER√äNCIAS (NOME E TELEFONE)"></textarea>
        <button onclick="copiarProposta()" class="btn btn-good" style="width:100%">üìã COPIAR PROPOSTA PARA WHATSAPP</button>
    </div>
</div>

<div id="docPanel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
        <h2>Documenta√ß√£o Necess√°ria</h2>
        <button onclick="fechar('docPanel')" class="btn btn-bad">X</button>
    </div>
    <div class="card">
        <p>‚úÖ CPF e RG<br>‚úÖ Comprovante de Renda<br>‚úÖ Comprovante de Resid√™ncia<br>‚úÖ Certid√£o Civil<br>‚úÖ 3 Refer√™ncias Pessoais<br>‚úÖ E-mail e Telefone</p>
        <button onclick="copiarDoc()" class="btn btn-primary" style="width:100%">üìã COPIAR LISTA PARA CLIENTE</button>
    </div>
</div>

<div id="adminPanel">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
        <h2>Gest√£o de Dados</h2>
        <button onclick="fechar('adminPanel')" class="btn btn-bad">X</button>
    </div>
    <div class="card" style="margin-bottom:15px">
        <label>Usu√°rios e Corretores</label>
        <div id="listaUsers"></div>
        <input type="text" id="newU" placeholder="Novo Usu√°rio">
        <input type="text" id="newP" placeholder="Senha">
        <button onclick="addU()" class="btn btn-good" style="width:100%">+ ADD</button>
    </div>
    <button onclick="gerarCodigoFinal()" class="btn btn-primary" style="width:100%">üíæ BAIXAR ATUALIZA√á√ÉO DO SISTEMA</button>
</div>

<main>
    <div class="card">
        <label>ANALISADOR DE CONVERSA (VOZ/TEXTO)</label>
        <textarea id="box" placeholder="Cole a conversa ou fale..." oninput="analisar(this.value)"></textarea>
    </div>
    <div id="respostas"></div>
</main>

<div class="footer">
    <button class="btn btn-primary" onclick="abrir('docPanel')">üìÇ DOCUMENTOS</button>
    <button class="btn btn-good" onclick="abrir('propPanel')">üìù PROPOSTA</button>
    <button id="btnFalar" class="btn btn-primary" style="grid-column: span 2; background: #3b82f6;" onclick="toggleFala()">üéôÔ∏è CLIQUE PARA FALAR</button>
</div>

<script id="dadosSistema">
    let BASE_DADOS = {
        indices: { ipca: "4.62", igpm: "0.59", selic: "11.75", val: "18" },
        usuarios: [{u:"admin", p:"123", role:"master"}],
        produtos: [
            {nome: "Morada Brasil", preco: 170000, keys: "morada, maggi", desc: "Pr√≥ximo √† Andr√© Maggi. Sem entrada. Parcelas R$ 713."},
            {nome: "Gran Can√°rio", preco: 95000, keys: "canario, fasipe", desc: "MT-140. Lotes ao lado da Fasipe Agro. Parcelas R$ 595."},
            {nome: "Ch√°caras Santa Carmem", preco: 135000, keys: "chacara, carmem, spc", desc: "1.800m¬≤. Sem consulta SPC/Serasa. Parcelas R$ 695."},
            {nome: "Casas MCMV", preco: 220000, keys: "casa, pronta, sinal", desc: "Sinal R$ 1.500. Parcelas R$ 699."}
        ],
        objecoes: [
            {keys: "caro, preco", t: "EST√Å CARO", l: "Leve: O valor √© justo pela localiza√ß√£o...", m: "M√©dia: O IGP-M e Selic mostram que terra √© mais seguro...", a: "Agressiva: Voc√™ quer pagar barato ou quer lucrar R$ 50 mil?"}
        ]
    };
</script>

<script>
    let db = BASE_DADOS;

    // BUSCA AUTOM√ÅTICA DE √çNDICES (API)
    async function atualizarIndices() {
        try {
            const res = await fetch('https://brasilapi.com.br/api/taxas/v1');
            const taxas = await res.json();
            const selicObjeto = taxas.find(t => t.nome === 'Selic');
            if(selicObjeto) db.indices.selic = selicObjeto.valor;
            renderizarIndices();
        } catch(e) { renderizarIndices(); }
    }

    function renderizarIndices() {
        document.getElementById('indicesTopo').innerHTML = `
            <div class="index-tag">SELIC: ${db.indices.selic}%</div>
            <div class="index-tag">IPCA: ${db.indices.ipca}%</div>
            <div class="index-tag">IGP-M: ${db.indices.igpm}%</div>
            <div class="index-tag">VALORIZA√á√ÉO: ${db.indices.val}%</div>
        `;
    }

    function fazerLogin() {
        const u = document.getElementById('userLogin').value;
        const p = document.getElementById('passLogin').value;
        const user = db.usuarios.find(x => x.u === u && x.p === p);
        if(user) {
            document.getElementById('loginOverlay').style.display='none';
            if(user.role === "master") document.getElementById('btnAdmin').style.display='block';
            atualizarIndices(); renderizarListas();
        } else { alert("Login Inv√°lido"); }
    }

    function analisar(val) {
        const t = val.toLowerCase();
        const res = document.getElementById('respostas');
        res.innerHTML = "";
        db.produtos.forEach(p => {
            if(p.keys.split(',').some(k => t.includes(k.trim()))) {
                const lucro = (p.preco * (parseFloat(db.indices.val)/100)) / 12;
                res.innerHTML += `
                    <div class="card">
                        <h3 style="color:var(--primary);margin:0">üìç ${p.nome}</h3>
                        <p style="font-size:13px">${p.desc}</p>
                        <div class="calc-box"><b>üõë ALERTA DE PERDA:</b> Se voc√™ adiar 1 m√™s, deixa de ganhar <b>R$ ${lucro.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</b>.</div>
                    </div>`;
            }
        });
        db.objecoes.forEach(o => {
            if(o.keys.split(',').some(k => t.includes(k.trim()))) {
                res.innerHTML += `<div class="card"><strong style="color:var(--gold)">üí• ${o.t}</strong>
                <div class="q-box"><b>üü¢ LEVE:</b> ${o.l}</div><div class="q-box"><b>üîµ M√âDIA:</b> ${o.m}</div><div class="q-box"><b>üî¥ AGRES:</b> ${o.a}</div></div>`;
            }
        });
    }

    function copiarDoc() {
        const texto = "üìù *LISTA DE DOCUMENTOS PARA RESERVA:*\n\n- CPF e RG\n- Comprovante de Renda (3 meses)\n- Comprovante de Resid√™ncia Atual\n- Certid√£o de Nascimento/Casamento\n- 3 Refer√™ncias Pessoais\n- E-mail e Telefone";
        navigator.clipboard.writeText(texto); alert("Lista de Documentos copiada!");
    }

    function copiarProposta() {
        const texto = `üìù *FORMALIZA√á√ÉO DE PROPOSTA*\n\n*CLIENTE:* ${document.getElementById('f_cliente').value}\n*CPF:* ${document.getElementById('f_cpf').value}\n*EMPREENDIMENTO:* ${document.getElementById('f_lote').value}\n*ENTRADA:* ${document.getElementById('f_entrada').value}\n*PARCELAMENTO:* ${document.getElementById('f_parc').value}\n*CONTATO:* ${document.getElementById('f_contato').value}\n*REFER√äNCIAS:* \n${document.getElementById('f_ref').value}`;
        navigator.clipboard.writeText(texto); alert("Proposta copiada para o WhatsApp!");
    }

    function abrir(id) { document.getElementById(id).style.display='block'; }
    function fechar(id) { document.getElementById(id).style.display='none'; }

    function addU() { db.usuarios.push({u: document.getElementById('newU').value, p: document.getElementById('newP').value, role: 'user'}); renderizarListas(); }
    function renderizarListas() {
        document.getElementById('listaUsers').innerHTML = db.usuarios.map((u, i) => `<div style="display:flex; justify-content:space-between; margin-bottom:5px"><span>${u.u}</span> <button onclick="db.usuarios.splice(${i},1);renderizarListas()">X</button></div>`).join('');
    }

    function gerarCodigoFinal() {
        let html = document.documentElement.outerHTML;
        html = html.replace(/let BASE_DADOS = \{[\s\S]*?\};/, `let BASE_DADOS = ${JSON.stringify(db, null, 4)};`);
        const blob = new Blob(["<!DOCTYPE html>\n" + html], {type: "text/html"});
        const a = document.createElement("a"); a.href = URL.createObjectURL(blob); a.download = "elite_sinop_v22.html"; a.click();
    }

    let rec;
    function toggleFala() {
        const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(!rec) {
            rec = new Speech(); rec.lang = 'pt-BR'; rec.continuous = true;
            rec.onresult = (e) => {
                const r = Array.from(e.results).map(res => res[0].transcript).join('');
                document.getElementById('box').value = r; analisar(r);
            };
        }
        const b = document.getElementById('btnFalar');
        if(b.classList.contains('active')) { rec.stop(); b.classList.remove('active'); b.innerText = "üéôÔ∏è CLIQUE PARA FALAR"; }
        else { rec.start(); b.classList.add('active'); b.innerText = "üõë OUVINDO..."; }
    }
</script>
</body>
</html>
