<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COPILOTO ‚Äî Gest√£o Total</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg:#f6f7fb; --panel:#ffffff; --text:#0b1220; --muted:#5b6474; --border:#e5e7eb;
    --shadow: 0 14px 34px rgba(17,24,39,.10); --primary:#4c5bd4; --primary2:#3f4bd0;
    --good:#16a34a; --warn:#f59e0b; --bad:#ef4444; --radius:16px;
  }

  *{box-sizing:border-box; font-family: 'Inter', sans-serif;}
  body{ margin:0; background: var(--bg); color: var(--text); -webkit-font-smoothing: antialiased; }

  /* TOPBAR */
  header{ position:sticky; top:0; z-index:50; background:rgba(255,255,255,.9); backdrop-filter: blur(10px); border-bottom:1px solid var(--border); padding:10px 20px; }
  .topbar{ max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; }
  
  /* GRID PRINCIPAL */
  main{ max-width:1200px; margin:20px auto; padding:0 20px; display:grid; grid-template-columns: 300px 1fr 400px; gap:20px; }

  /* CARDS */
  .card{ background:white; border-radius:var(--radius); border:1px solid var(--border); box-shadow: 0 4px 6px rgba(0,0,0,0.02); overflow:hidden; }
  .card-head{ padding:15px; border-bottom:1px solid var(--border); background:#fafafa; font-weight:800; font-size:14px; }
  .card-body{ padding:15px; }

  /* FORMUL√ÅRIOS */
  input, textarea, select { 
    width:100%; padding:10px; margin: 5px 0 15px 0; border:1px solid var(--border); border-radius:8px; font-size:14px;
  }
  label{ font-size:12px; font-weight:700; color:var(--muted); text-transform: uppercase; }

  /* BOT√ïES */
  button{ padding:10px 15px; border-radius:8px; border:none; cursor:pointer; font-weight:700; transition: 0.2s; font-size:13px; }
  .btn-primary{ background: var(--primary); color:white; }
  .btn-primary:hover{ background: var(--primary2); }
  .btn-outline{ border:1px solid var(--border); background:white; }
  .btn-danger{ background: #fee2e2; color: #b91c1c; }
  .btn-export{ background: #000; color: #fff; width:100%; margin-top:10px; font-size:15px; padding:15px; }

  /* ADMIN DRAWER */
  #adminDrawer{ position:fixed; inset:0; display:none; z-index:100; }
  #adminDrawer.show{ display:flex; }
  .drawer-content{ width:min(800px, 95%); background:white; margin-left:auto; height:100%; box-shadow:-10px 0 30px rgba(0,0,0,0.1); display:flex; flex-direction:column; animation: slide 0.3s ease-out; }
  @keyframes slide { from{transform: translateX(100%)} to{transform: translateX(0)} }
  .drawer-body{ flex:1; overflow-y:auto; padding:30px; }
  
  /* TABELAS ADMIN */
  .data-list{ margin-top:20px; border-top:1px solid var(--border); }
  .data-item{ display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid #f0f0f0; font-size:13px; }

  /* RESPONSIVIDADE */
  @media (max-width: 1000px){ main{ grid-template-columns: 1fr; } }

  .toast{ position:fixed; bottom:20px; left:50%; transform:translateX(-50%); background:#333; color:white; padding:10px 30px; border-radius:50px; display:none; z-index:1000; }
</style>
</head>
<body>

<header>
  <div class="topbar">
    <div><strong>COPILOTO</strong> <small style="color:var(--muted)">v2.6</small></div>
    <div id="userTools" style="display:none; gap:10px;">
      <button class="btn-outline" onclick="openAdmin()">‚öôÔ∏è Painel de Edi√ß√£o</button>
      <button class="btn-danger" onclick="location.reload()">Sair</button>
    </div>
  </div>
</header>

<div id="loginArea" style="position:fixed; inset:0; background:var(--bg); z-index:200; display:flex; align-items:center; justify-content:center;">
  <div class="card" style="width:340px; padding:20px;">
    <h3>Acesso Restrito</h3>
    <label>Login</label><input id="lUser" type="text" value="edson">
    <label>Senha</label><input id="lPass" type="password" value="2026">
    <button class="btn-primary" onclick="initApp()" style="width:100%">Entrar</button>
  </div>
</div>

<main id="appMain" style="opacity:0.3; pointer-events:none;">
  <aside>
    <div class="card">
      <div class="card-head">PRODUTO DETECTADO</div>
      <div class="card-body">
        <h2 id="view-prod-name" style="margin:0; color:var(--primary)">Aguardando...</h2>
        <ul id="view-prod-info" style="font-size:14px; margin-top:15px; color:var(--muted)"></ul>
      </div>
    </div>
  </aside>

  <section>
    <div class="card">
      <div class="card-head">ENTRADA DO CLIENTE</div>
      <div class="card-body">
        <textarea id="mainInput" placeholder="O que o cliente disse? (Ex: Achei o Cedros Caro)" style="min-height:200px; font-size:16px;"></textarea>
        <div style="display:flex; gap:10px">
          <button class="btn-primary" onclick="toggleMic()">üéôÔ∏è Iniciar Microfone</button>
          <button class="btn-outline" onclick="clearInput()">Limpar</button>
        </div>
      </div>
    </div>
  </section>

  <aside>
    <div class="card" style="margin-bottom:15px"><div class="card-body"><strong>Leve:</strong><p id="res-a">‚Äî</p></div></div>
    <div class="card" style="margin-bottom:15px"><div class="card-body"><strong>M√©dia:</strong><p id="res-b">‚Äî</p></div></div>
    <div class="card" style="margin-bottom:15px"><div class="card-body"><strong>Agressiva:</strong><p id="res-c">‚Äî</p></div></div>
    <div class="card"><div class="card-body"><canvas id="growthChart"></canvas></div></div>
  </aside>
</main>

<div id="adminDrawer">
  <div style="flex:1; background:rgba(0,0,0,0.5)" onclick="closeAdmin()"></div>
  <div class="drawer-content">
    <div class="drawer-body">
      <h1>Painel de Edi√ß√£o</h1>
      <p style="color:var(--muted)">Gerencie seus dados e exporte o c√≥digo para o GitHub.</p>
      
      <button class="btn-export" onclick="copyFullCode()">üíæ COPIAR C√ìDIGO ATUALIZADO (INDEX.HTML)</button>
      
      <hr style="margin:30px 0; border:0; border-top:1px solid #eee;">

      <h3>üì¶ Gerenciar Produtos</h3>
      <div class="card-body" style="background:#f9f9f9; border-radius:10px;">
        <label>Nome do Produto</label><input id="fProdName" placeholder="Ex: Cedros">
        <label>Chaves (v√≠rgula)</label><input id="fProdKeys" placeholder="cedros, bufalo, maggi">
        <label>Taxa Anual %</label><input id="fProdRate" type="number" value="12">
        <label>Infos (1 por linha)</label><textarea id="fProdInfo" style="min-height:60px"></textarea>
        <button class="btn-primary" onclick="addData('products')">Salvar Produto</button>
      </div>
      <div id="list-products" class="data-list"></div>

      <h3 style="margin-top:40px">üö´ Gerenciar Obje√ß√µes</h3>
      <div class="card-body" style="background:#f9f9f9; border-radius:10px;">
        <label>Chaves da Obje√ß√£o</label><input id="fObjKeys" placeholder="caro, pre√ßo, valor">
        <label>Resposta Leve</label><textarea id="fObjA"></textarea>
        <label>Resposta M√©dia</label><textarea id="fObjB"></textarea>
        <label>Resposta Agressiva</label><textarea id="fObjC"></textarea>
        <button class="btn-primary" onclick="addData('objections')">Salvar Obje√ß√£o</button>
      </div>
      <div id="list-objections" class="data-list"></div>

    </div>
    <div style="padding:20px; border-top:1px solid #eee"><button class="btn-outline" style="width:100%" onclick="closeAdmin()">Fechar Painel</button></div>
  </div>
</div>

<div id="toast" class="toast">Copiado!</div>

<script id="databaseScript">
  // ESTA √â A BASE QUE O BOT√ÉO DE EXPORTAR IR√Å ATUALIZAR
  let base = {
    products: [
      { name: "CEDROS JARDINS", keys: ["cedros", "b√∫falo"], info: ["Lotes 200m¬≤", "Parcelas R$ 753"], rate: 14 },
      { name: "MORADA BRASIL", keys: ["morada"], info: ["Lotes 250m¬≤", "Parcelas R$ 713"], rate: 12 }
    ],
    objections: [
      { keys: ["caro", "pre√ßo", "valor"], a: "Entendo. √â caro comparado a qu√™?", b: "O investimento se paga com a valoriza√ß√£o.", c: "Se eu baixar a parcela, fechamos?" }
    ]
  };
</script>

<script>
let chart;

function initApp() {
  const u = document.getElementById("lUser").value;
  const p = document.getElementById("lPass").value;
  if(u === "edson" && p === "2026") {
    document.getElementById("loginArea").style.display = "none";
    document.getElementById("appMain").style.opacity = "1";
    document.getElementById("appMain").style.pointerEvents = "all";
    document.getElementById("userTools").style.display = "flex";
    initChart();
    renderLists();
  }
}

// L√ìGICA DE INPUT
document.getElementById("mainInput").addEventListener("input", function() {
  const text = this.value.toLowerCase();
  
  // Detectar Produto
  const p = base.products.find(item => item.keys.some(k => text.includes(k.trim().toLowerCase())));
  if(p) {
    document.getElementById("view-prod-name").innerText = p.name;
    document.getElementById("view-prod-info").innerHTML = p.info.map(i => `<li>${i}</li>`).join("");
    updateChart(p.rate);
  }

  // Detectar Obje√ß√£o
  const o = base.objections.find(item => item.keys.some(k => text.includes(k.trim().toLowerCase())));
  if(o) {
    document.getElementById("res-a").innerText = o.a;
    document.getElementById("res-b").innerText = o.b;
    document.getElementById("res-c").innerText = o.c;
  }
});

// GEST√ÉO DE DADOS (ADMIN)
function addData(type) {
  if(type === 'products') {
    base.products.push({
      name: document.getElementById("fProdName").value.toUpperCase(),
      keys: document.getElementById("fProdKeys").value.split(","),
      rate: Number(document.getElementById("fProdRate").value),
      info: document.getElementById("fProdInfo").value.split("\n")
    });
  } else {
    base.objections.push({
      keys: document.getElementById("fObjKeys").value.split(","),
      a: document.getElementById("fObjA").value,
      b: document.getElementById("fObjB").value,
      c: document.getElementById("fObjC").value
    });
  }
  renderLists();
  showToast("Adicionado!");
}

function removeData(type, index) {
  base[type].splice(index, 1);
  renderLists();
}

function renderLists() {
  document.getElementById("list-products").innerHTML = base.products.map((p, i) => `
    <div class="data-item"><span>${p.name}</span> <button class="btn-danger" onclick="removeData('products', ${i})">Remover</button></div>
  `).join("");
  
  document.getElementById("list-objections").innerHTML = base.objections.map((o, i) => `
    <div class="data-item"><span>Obje√ß√£o: ${o.keys[0]}</span> <button class="btn-danger" onclick="removeData('objections', ${i})">Remover</button></div>
  `).join("");
}

// EXPORTA√á√ÉO M√ÅGICA
function copyFullCode() {
  // Pegamos o script do database e atualizamos ele com os novos valores
  const scriptDb = document.getElementById("databaseScript");
  scriptDb.innerHTML = `\n  let base = ${JSON.stringify(base, null, 2)};\n`;

  // Pegamos o HTML completo
  const fullHtml = "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
  
  navigator.clipboard.writeText(fullHtml).then(() => {
    alert("C√ìDIGO COMPLETO COPIADO!\n\nAgora seu index.html cont√©m todos os produtos e obje√ß√µes que voc√™ acabou de criar. √â s√≥ colar no arquivo e salvar.");
  });
}

// GR√ÅFICO
function initChart() {
  const ctx = document.getElementById('growthChart').getContext('2d');
  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['12m', '24m', '36m', '48m', '60m'],
      datasets: [{ label: 'Valoriza√ß√£o', data: [100, 115, 130, 150, 175], borderColor: '#4c5bd4', backgroundColor: 'rgba(76,91,212,0.1)', fill: true }]
    },
    options: { plugins: { legend: { display: false } } }
  });
}

function updateChart(rate) {
  let val = 100000;
  let newData = [val];
  for(let i=1; i<5; i++) { val *= (1 + (rate/100)); newData.push(Math.round(val)); }
  chart.data.datasets[0].data = newData;
  chart.update();
}

function openAdmin() { document.getElementById("adminDrawer").classList.add("show"); }
function closeAdmin() { document.getElementById("adminDrawer").classList.remove("show"); }
function showToast(m) { const t = document.getElementById("toast"); t.innerText = m; t.style.display="block"; setTimeout(()=>t.style.display="none", 2000); }
function clearInput() { document.getElementById("mainInput").value = ""; }

// VOZ
let rec;
if(window.webkitSpeechRecognition) {
  rec = new webkitSpeechRecognition();
  rec.lang = 'pt-BR';
  rec.continuous = true;
  rec.onresult = (e) => {
    document.getElementById("mainInput").value += " " + e.results[e.results.length-1][0].transcript;
    document.getElementById("mainInput").dispatchEvent(new Event('input'));
  };
}
function toggleMic() { rec.start(); showToast("Ouvindo..."); }
</script>

</body>
</html>
