<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COPILOTO ‚Äî Assistente de Obje√ß√µes em Tempo Real</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg:#f6f7fb;
    --panel:#ffffff;
    --text:#0b1220;
    --muted:#5b6474;
    --border:#e5e7eb;
    --shadow: 0 14px 34px rgba(17,24,39,.10);
    --shadow2: 0 8px 22px rgba(17,24,39,.08);
    --primary:#4c5bd4;
    --primary2:#3f4bd0;
    --ring: rgba(76,91,212,.22);
    --good:#16a34a;
    --warn:#f59e0b;
    --bad:#ef4444;
    --chip:#f3f4f6;
    --radius:16px;
    --radius2:22px;
    --tap:48px;
    --fx: 860ms;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background:
      radial-gradient(1000px 520px at 12% -4%, rgba(76,91,212,.14), transparent 58%),
      radial-gradient(900px 520px at 92% 10%, rgba(245,158,11,.10), transparent 58%),
      radial-gradient(720px 520px at 40% 100%, rgba(22,163,74,.07), transparent 60%),
      var(--bg);
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
  }

  /* TOPBAR */
  header{position:sticky; top:0; z-index:5; background:rgba(255,255,255,.86); backdrop-filter: blur(12px); border-bottom:1px solid rgba(229,231,235,.95);}
  .topbar{display:flex; align-items:center; justify-content:space-between; padding:14px 18px; max-width:1200px; margin:0 auto; gap:12px;}
  .brand h1{margin:0; font-size:18px; letter-spacing:.3px; font-weight:900;}
  .brand span{font-size:12px; color:var(--muted); font-weight:600;}

  .statusline{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
  .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid rgba(229,231,235,.95); border-radius:999px; background:rgba(255,255,255,.92); font-size:12px; color:var(--muted); font-weight:600;}
  .dot{width:8px; height:8px; border-radius:999px; background:#cbd5e1}
  .dot.on{background: var(--good)}

  /* GRID */
  main{max-width:1200px; margin:0 auto; padding:18px}
  .grid{display:grid; grid-template-columns: 320px 1fr 430px; gap:16px; align-items:start;}

  /* CARDS */
  .card{background:rgba(255,255,255,.92); border:1px solid rgba(229,231,235,.92); border-radius:var(--radius); box-shadow: var(--shadow2); overflow:hidden; margin-bottom: 12px;}
  .card .head{padding:14px; border-bottom:1px solid rgba(229,231,235,.78); display:flex; align-items:flex-start; justify-content:space-between;}
  .card .body{padding:14px}
  
  .title h2, .title h3, .title h4 {margin:0; font-size:14px; font-weight:900;}
  .subtitle{font-size:12px; color:var(--muted); font-weight:600;}

  /* INPUT & RESPONSES */
  textarea{width:100%; min-height:200px; padding:14px; border-radius:14px; border:1px solid var(--border); font-size:15px; outline:none;}
  .responseText{font-size:15px; font-weight:650; white-space:pre-wrap; margin:10px 0;}
  
  /* BUTTONS */
  button{padding:10px 16px; border-radius:12px; border:1px solid var(--border); cursor:pointer; font-weight:800; transition: 0.2s;}
  .primary{background: var(--primary); color:white; border:none;}
  .ghost{background: rgba(76,91,212,0.1); color: var(--primary2);}
  .danger{background: rgba(239,68,68,0.1); color: #7f1d1d;}

  /* ADMIN DRAWER */
  .drawer{position:fixed; inset:0; display:none; z-index:100;}
  .drawer.show{display:block}
  .backdrop{position:absolute; inset:0; background:rgba(0,0,0,0.5);}
  .panel{position:absolute; right:0; top:0; height:100%; width:min(600px, 100%); background:white; display:flex; flex-direction:column; box-shadow: -5px 0 15px rgba(0,0,0,0.1);}
  .panelBody{padding:20px; overflow-y:auto; flex:1;}

  /* TOAST */
  .toast{position:fixed; bottom:20px; right:20px; background:#333; color:white; padding:12px 20px; border-radius:10px; display:none; z-index:1000;}

  @media (max-width: 980px){ .grid{grid-template-columns: 1fr;} }
</style>
</head>
<body>

<div id="loginOverlay" class="overlay" style="position:fixed; inset:0; background:rgba(11,18,32,0.8); display:flex; align-items:center; justify-content:center; z-index:200;">
  <div class="card" style="width:350px; padding:20px; background:white;">
    <div class="title"><h2>Login COPILOTO</h2></div>
    <div style="margin-top:15px">
      <label>Usu√°rio</label>
      <input id="loginUser" type="text" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
      <label>Senha</label>
      <input id="loginPass" type="password" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ddd;">
      <button class="primary" onclick="doLogin()" style="width:100%; margin-top:15px;">Entrar</button>
      <p id="loginError" style="color:red; font-size:12px; display:none; margin-top:10px;">Credenciais incorretas.</p>
    </div>
  </div>
</div>

<header>
  <div class="topbar">
    <div class="brand"><h1>COPILOTO</h1><span>Vendas 2026</span></div>
    <div class="statusline">
      <div class="pill"><span class="dot" id="micDot"></span> <span id="micLabel">Mic: OFF</span></div>
      <button id="adminBtn" class="ghost" style="display:none" onclick="openAdmin()">‚öôÔ∏è Admin</button>
      <button id="logoutBtn" class="danger" style="display:none" onclick="logout()">Sair</button>
    </div>
  </div>
</header>

<main>
  <div class="grid">
    <div class="card">
      <div class="head"><div class="title"><h3>Produto</h3></div></div>
      <div class="body">
        <h4 id="prod-name">Aguardando...</h4>
        <ul id="prod-info" style="font-size:13px; padding-left:20px; font-weight:600;"></ul>
      </div>
    </div>

    <div class="card">
      <div class="head"><div class="title"><h3>Di√°logo</h3></div></div>
      <div class="body">
        <textarea id="input" placeholder="Digite ou fale algo..."></textarea>
        <div style="margin-top:10px; display:flex; gap:10px;">
          <button class="primary" id="micBtn" onclick="toggleListening()">üéôÔ∏è Ouvir</button>
          <button onclick="document.getElementById('input').value=''; processInput();">Limpar</button>
        </div>
      </div>
    </div>

    <div id="responsesWrap">
      <div class="card"><div class="body"><strong>Leve:</strong><p id="r1" class="responseText">‚Äî</p><button onclick="copy('r1')">Copiar</button></div></div>
      <div class="card"><div class="body"><strong>M√©dia:</strong><p id="r2" class="responseText">‚Äî</p><button onclick="copy('r2')">Copiar</button></div></div>
      <div class="card"><div class="body"><strong>Agressiva:</strong><p id="r3" class="responseText">‚Äî</p><button onclick="copy('r3')">Copiar</button></div></div>
      
      <div class="card">
        <div class="head"><h4>Valoriza√ß√£o (5 anos)</h4></div>
        <div class="body"><canvas id="growthChart" height="150"></canvas></div>
      </div>
    </div>
  </div>
</main>

<div class="drawer" id="adminDrawer">
  <div class="backdrop" onclick="closeAdmin()"></div>
  <div class="panel">
    <div class="panelBody">
      <h2>Painel Administrativo</h2>
      <hr>
      <div style="background:#f9f9f9; padding:15px; border-radius:10px; margin-bottom:20px; border: 1px solid #eee;">
        <h3 style="margin-top:0">Exportar Projeto</h3>
        <p style="font-size:12px; color: #666;">Use o bot√£o abaixo para copiar o <strong>c√≥digo HTML completo</strong> j√° atualizado com os novos produtos e obje√ß√µes inseridos nesta sess√£o.</p>
        <button class="primary" onclick="copyFullCode()" style="width:100%; background: #000;">üöÄ Copiar C√≥digo Index.html Atualizado</button>
      </div>
      <p>Gerencie produtos, usu√°rios e obje√ß√µes nos campos abaixo (Simula√ß√£o).</p>
      <button class="danger" onclick="closeAdmin()">Fechar Admin</button>
    </div>
  </div>
</div>

<div id="toast" class="toast">Mensagem</div>

<script>
/* DADOS BASE */
let base = {
  products: [
    { name: "CEDROS JARDINS", keys: ["cedros", "b√∫falo", "andr√© maggi"], info: ["Lotes 200m¬≤", "Sem Entrada"], rate: 14 },
    { name: "MORADA BRASIL", keys: ["morada"], info: ["Parcelas R$ 713"], rate: 12 }
  ],
  objections: [
    { keys: ["caro", "pre√ßo"], a: "Caro em rela√ß√£o a qu√™?", b: "O investimento se paga em 2 anos.", c: "Podemos ajustar a parcela, mas o lote √© √∫nico." }
  ]
};

let chartInstance = null;

/* LOGIN */
function doLogin() {
  const u = document.getElementById("loginUser").value;
  const p = document.getElementById("loginPass").value;
  if(u === "edson" && p === "2026") {
    document.getElementById("loginOverlay").style.display = "none";
    document.getElementById("adminBtn").style.display = "inline-block";
    document.getElementById("logoutBtn").style.display = "inline-block";
    showToast("Bem-vindo, Edson!");
    initChart();
  } else {
    document.getElementById("loginError").style.display = "block";
  }
}

function logout() { location.reload(); }

/* ADMIN */
function openAdmin() { document.getElementById("adminDrawer").classList.add("show"); }
function closeAdmin() { document.getElementById("adminDrawer").classList.remove("show"); }

/* L√ìGICA DE DETEC√á√ÉO */
document.getElementById("input").addEventListener("input", processInput);

function processInput() {
  const text = document.getElementById("input").value.toLowerCase();
  
  // Detectar Produto
  const prod = base.products.find(p => p.keys.some(k => text.includes(k)));
  if(prod) {
    document.getElementById("prod-name").innerText = prod.name;
    document.getElementById("prod-info").innerHTML = prod.info.map(i => `<li>${i}</li>`).join("");
    updateChart(prod.rate);
  }

  // Detectar Obje√ß√£o
  const obj = base.objections.find(o => o.keys.some(k => text.includes(k)));
  if(obj) {
    document.getElementById("r1").innerText = obj.a;
    document.getElementById("r2").innerText = obj.b;
    document.getElementById("r3").innerText = obj.c;
  }
}

/* GR√ÅFICO (Chart.js) */
function initChart() {
  const ctx = document.getElementById('growthChart').getContext('2d');
  chartInstance = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Ano 1', 'Ano 2', 'Ano 3', 'Ano 4', 'Ano 5'],
      datasets: [{
        label: 'Valoriza√ß√£o Estimada (R$)',
        data: [100000, 112000, 125000, 140000, 157000],
        borderColor: '#4c5bd4',
        tension: 0.3,
        fill: true,
        backgroundColor: 'rgba(76,91,212,0.1)'
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } } }
  });
}

function updateChart(rate) {
  if(!chartInstance) return;
  let val = 120000;
  const newData = [val];
  for(let i=1; i<5; i++) {
    val = val * (1 + (rate/100));
    newData.push(Math.round(val));
  }
  chartInstance.data.datasets[0].data = newData;
  chartInstance.update();
}

/* UTILIT√ÅRIOS */
function copy(id) {
  const t = document.getElementById(id).innerText;
  navigator.clipboard.writeText(t);
  showToast("Copiado!");
}

function showToast(msg) {
  const toast = document.getElementById("toast");
  toast.innerText = msg;
  toast.style.display = "block";
  setTimeout(() => toast.style.display = "none", 2000);
}

/* EXPORTAR C√ìDIGO ATUALIZADO */
function copyFullCode() {
  // Captura o HTML atual e injeta a base de dados atualizada no script
  let fullHtml = document.documentElement.outerHTML;
  const dataScript = `<script>let base = ${JSON.stringify(base, null, 2)};<\/script>`;
  
  // Cria uma vers√£o limpa para c√≥pia
  const finalCode = "<!DOCTYPE html>\n" + fullHtml;
  
  navigator.clipboard.writeText(finalCode);
  alert("C√ìDIGO COMPLETO COPIADO!\n\nAgora voc√™ pode colar no seu arquivo index.html e subir para o GitHub.");
}

/* RECONHECIMENTO DE VOZ */
let recognition;
if ('webkitSpeechRecognition' in window) {
  recognition = new webkitSpeechRecognition();
  recognition.lang = 'pt-BR';
  recognition.continuous = true;
  recognition.onresult = (event) => {
    const result = event.results[event.results.length - 1][0].transcript;
    document.getElementById("input").value += " " + result;
    processInput();
  };
}

function toggleListening() {
  const dot = document.getElementById("micDot");
  if(dot.classList.contains("on")) {
    recognition.stop();
    dot.classList.remove("on");
    document.getElementById("micLabel").innerText = "Mic: OFF";
  } else {
    recognition.start();
    dot.classList.add("on");
    document.getElementById("micLabel").innerText = "Mic: ON";
  }
}
</script>

</body>
</html>
