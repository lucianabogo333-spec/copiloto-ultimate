<!-- ===================== EXTENS√ïES FUTURAS (PARTE 1) ===================== -->
<script>
/*
  ‚ö†Ô∏è PARTE 1 ‚Äì CAMADA DE SUPORTE
  Nada aqui altera formul√°rios, CRUD ou detec√ß√£o atual.
  Apenas adiciona capacidades novas para pr√≥ximas partes.
*/

/* ===================== TAXAS ECON√îMICAS (BASE) ===================== */
/*
  Estas taxas ser√£o atualizadas automaticamente na PARTE 3.
  Por enquanto, valores iniciais seguros.
*/
const ECONOMIC_INDEXES = {
  selic: { value: 11.25, updated: null },
  ipca:  { value: 4.50,  updated: null },
  igpm:  { value: 3.80,  updated: null }
};

/* ===================== EXTENS√ÉO DE PRODUTO (SEM QUEBRAR) ===================== */
/*
  Cada produto pode TER (n√£o obrigat√≥rio):
  - rateType: "fixo" | "selic" | "ipca" | "igpm"
  - annualRate: number
*/
function enrichProductsWithRates(){
  base.products = (base.products || []).map(p => {
    if(!p.rateType){
      return {
        ...p,
        rateType: "fixo",
        annualRate: 10 // padr√£o conservador
      };
    }
    return p;
  });
}

/* ===================== CALCULADORA DE PROCRASTINA√á√ÉO ===================== */
/*
  C√°lculo de custo de esperar (m√™s / ano)
*/
function calcProcrastination({
  valorInicial,
  taxaAnual,
  meses
}){
  const taxaMensal = Math.pow(1 + taxaAnual/100, 1/12) - 1;
  const valorFinal = valorInicial * Math.pow(1 + taxaMensal, meses);

  return {
    inicial: valorInicial,
    final: Number(valorFinal.toFixed(2)),
    perda: Number((valorFinal - valorInicial).toFixed(2))
  };
}

/* ===================== GR√ÅFICO ‚Äì BASE (Canvas) ===================== */
function buildInvestmentProjection({
  valorInicial,
  taxaAnual,
  anos = 5
}){
  const data = [];
  let valor = valorInicial;

  for(let i=1;i<=anos;i++){
    valor = valor * (1 + taxaAnual/100);
    data.push({
      ano: i,
      valor: Number(valor.toFixed(2))
    });
  }
  return data;
}

/* ===================== BOT√ÉO FORMALIZA√á√ÉO ===================== */
function openFormalizacao(){
  window.location.href = "https://lucianabogo333-spec.github.io/formalizacao-proposta/";
}

/* ===================== INSER√á√ÉO SEGURA DO BOT√ÉO ===================== */
document.addEventListener("DOMContentLoaded", () => {
  const toolbar = document.querySelector(".toolbar .btnRow");
  if(toolbar && !document.getElementById("btnFormalizacao")){
    const btn = document.createElement("button");
    btn.id = "btnFormalizacao";
    btn.className = "ghost";
    btn.textContent = "üìÑ Formalizar proposta";
    btn.onclick = openFormalizacao;
    toolbar.appendChild(btn);
  }

  // garante que produtos antigos ganhem taxa padr√£o
  enrichProductsWithRates();
});
</script>
<!-- ===================== FIM PARTE 1 ===================== -->
<!-- ===================== PARTE 2 ‚Äî CALCULADORA DE PROCRASTINA√á√ÉO ===================== -->
<style>
  .calcCard{
    margin-top:14px;
  }
  .calcGrid{
    display:grid;
    grid-template-columns: repeat(3,1fr);
    gap:10px;
  }
  .calcResult{
    background: rgba(243,244,246,.6);
    border:1px solid rgba(229,231,235,.9);
    border-radius:14px;
    padding:12px;
    text-align:center;
  }
  .calcResult h5{
    margin:0;
    font-size:12px;
    color:var(--muted);
    font-weight:800;
  }
  .calcResult strong{
    display:block;
    margin-top:6px;
    font-size:15px;
    font-weight:950;
  }
</style>

<script>
/* ===================== UI DA CALCULADORA ===================== */
function renderProcrastinationCalc(product){
  const containerId = "calcProcrastination";
  let container = document.getElementById(containerId);

  if(!product){
    if(container) container.remove();
    return;
  }

  if(!container){
    container = document.createElement("div");
    container.id = containerId;
    container.className = "card calcCard fx";

    container.innerHTML = `
      <div class="head">
        <div class="title">
          <h3>Custo da Procrastina√ß√£o</h3>
          <p class="subtitle">Quanto custa esperar para decidir.</p>
        </div>
      </div>
      <div class="body">
        <div class="formGrid two">
          <div>
            <label>Valor do investimento (R$)</label>
            <input id="calcValor" type="text" placeholder="ex: 50000">
          </div>
          <div>
            <label>Prazo (meses)</label>
            <input id="calcMeses" type="text" placeholder="ex: 12">
          </div>
        </div>

        <div class="calcGrid" style="margin-top:14px">
          <div class="calcResult">
            <h5>Valor futuro</h5>
            <strong id="calcFinal">‚Äî</strong>
          </div>
          <div class="calcResult">
            <h5>Custo de esperar</h5>
            <strong id="calcPerda">‚Äî</strong>
          </div>
          <div class="calcResult">
            <h5>Taxa anual</h5>
            <strong id="calcTaxa">‚Äî</strong>
          </div>
        </div>
      </div>
    `;

    prodCard.after(container);
  }

  const taxa =
    product.rateType === "selic" ? ECONOMIC_INDEXES.selic.value :
    product.rateType === "ipca"  ? ECONOMIC_INDEXES.ipca.value  :
    product.rateType === "igpm"  ? ECONOMIC_INDEXES.igpm.value  :
    product.annualRate;

  document.getElementById("calcTaxa").textContent = taxa + "% a.a.";

  const valorEl = document.getElementById("calcValor");
  const mesesEl = document.getElementById("calcMeses");

  function recalc(){
    const valor = parseFloat(valorEl.value.replace(",", "."));
    const meses = parseInt(mesesEl.value);

    if(!valor || !meses) return;

    const r = calcProcrastination({
      valorInicial: valor,
      taxaAnual: taxa,
      meses
    });

    document.getElementById("calcFinal").textContent =
      "R$ " + r.final.toLocaleString("pt-BR");

    document.getElementById("calcPerda").textContent =
      "R$ " + r.perda.toLocaleString("pt-BR");
  }

  valorEl.oninput = recalc;
  mesesEl.oninput = recalc;
}

/* ===================== INTEGRA√á√ÉO COM DETEC√á√ÉO ===================== */
/* Hook seguro: reaproveita o produto j√° detectado */
const _originalProcessText = processText;
processText = function(force){
  _originalProcessText(force);
  renderProcrastinationCalc(lastProduct);
};
</script>
<!-- ===================== FIM PARTE 2 ===================== -->
<!-- ===================== PARTE 3 ‚Äî INDICADORES ECON√îMICOS ===================== -->
<style>
  .ecoPanel{
    position:fixed;
    right:16px;
    bottom:16px;
    z-index:40;
    background:rgba(255,255,255,.96);
    border:1px solid rgba(229,231,235,.95);
    border-radius:16px;
    box-shadow: 0 14px 28px rgba(17,24,39,.14);
    padding:12px 14px;
    min-width:220px;
    font-size:12px;
  }
  .ecoTitle{
    font-weight:900;
    font-size:12px;
    margin-bottom:8px;
    color:#0b1220;
  }
  .ecoRow{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin:4px 0;
    font-weight:800;
  }
  .ecoRow span{
    color:var(--muted);
    font-weight:700;
  }
  .ecoUpdated{
    margin-top:6px;
    font-size:10px;
    color:var(--muted);
    text-align:right;
  }
</style>

<script>
/* ===================== APIs OFICIAIS ===================== */
const API_SELIC = "https://api.bcb.gov.br/dados/serie/bcdata.sgs.11/dados?formato=json";
const API_IPCA  = "https://api.bcb.gov.br/dados/serie/bcdata.sgs.433/dados?formato=json";
const API_IGPM  = "https://api.bcb.gov.br/dados/serie/bcdata.sgs.189/dados?formato=json";

/* ===================== FETCH SEGURO ===================== */
async function fetchIndex(api){
  try{
    const res = await fetch(api);
    const data = await res.json();
    const last = data[data.length - 1];
    return parseFloat(last.valor.replace(",", "."));
  }catch(e){
    return null;
  }
}

/* ===================== ATUALIZA√á√ÉO ===================== */
async function updateEconomicIndexes(){
  const selic = await fetchIndex(API_SELIC);
  const ipca  = await fetchIndex(API_IPCA);
  const igpm  = await fetchIndex(API_IGPM);

  if(selic) ECONOMIC_INDEXES.selic.value = selic;
  if(ipca)  ECONOMIC_INDEXES.ipca.value  = ipca;
  if(igpm)  ECONOMIC_INDEXES.igpm.value  = igpm;

  const now = new Date().toLocaleDateString("pt-BR");
  ECONOMIC_INDEXES.selic.updated = now;
  ECONOMIC_INDEXES.ipca.updated  = now;
  ECONOMIC_INDEXES.igpm.updated  = now;

  renderEcoPanel();
}

/* ===================== UI ===================== */
function renderEcoPanel(){
  let panel = document.getElementById("ecoPanel");
  if(!panel){
    panel = document.createElement("div");
    panel.id = "ecoPanel";
    panel.className = "ecoPanel";
    document.body.appendChild(panel);
  }

  panel.innerHTML = `
    <div class="ecoTitle">Indicadores Econ√¥micos</div>
    <div class="ecoRow">SELIC <span>${ECONOMIC_INDEXES.selic.value}%</span></div>
    <div class="ecoRow">IPCA <span>${ECONOMIC_INDEXES.ipca.value}%</span></div>
    <div class="ecoRow">IGP-M <span>${ECONOMIC_INDEXES.igpm.value}%</span></div>
    <div class="ecoUpdated">Atualizado: ${ECONOMIC_INDEXES.selic.updated || "‚Äî"}</div>
  `;
}

/* ===================== BOOT ===================== */
document.addEventListener("DOMContentLoaded", () => {
  renderEcoPanel();
  updateEconomicIndexes();
  // Atualiza 1x por dia
  setInterval(updateEconomicIndexes, 1000 * 60 * 60 * 24);
});
</script>
<!-- ===================== FIM PARTE 3 ===================== -->
<!-- ===================== PARTE 4 ‚Äî GR√ÅFICO 5 ANOS (Canvas) ===================== -->
<style>
  .chartBtn{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:12px 14px;
    min-height: var(--tap);
    border-radius:14px;
    cursor:pointer;
    font-weight:900;
    font-size:14px;
    letter-spacing:.1px;
    border:1px solid rgba(76,91,212,.22);
    background: rgba(76,91,212,.08);
    color:#1f2a9a;
    box-shadow: 0 2px 0 rgba(17,24,39,.03);
  }
  .chartBtn:hover{
    border-color: rgba(76,91,212,.34);
    box-shadow: 0 14px 26px rgba(17,24,39,.10);
    transform: translateY(-1px);
  }

  .chartOverlay{
    position:fixed; inset:0;
    background:rgba(11,18,32,.62);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:50;
    padding:16px;
  }
  .chartOverlay.show{display:flex}

  .chartModal{
    width:min(980px, 100%);
    background: rgba(255,255,255,.98);
    border:1px solid rgba(229,231,235,.92);
    border-radius: var(--radius2);
    box-shadow: var(--shadow);
    overflow:hidden;
    animation: modalIn 520ms ease-out 1;
  }
  .chartHead{
    padding:14px 14px 10px;
    border-bottom:1px solid rgba(229,231,235,.88);
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:10px;
  }
  .chartHead h3{
    margin:0;
    font-size:14px;
    font-weight:950;
    letter-spacing:.2px;
  }
  .chartBody{
    padding:14px;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .chartMeta{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    align-items:center;
    justify-content:space-between;
  }
  .chartMeta .chip{font-weight:800}
  .chartCanvasWrap{
    border:1px solid rgba(229,231,235,.95);
    border-radius:16px;
    background:rgba(243,244,246,.35);
    overflow:hidden;
  }
  canvas#investChart{
    width:100%;
    height:420px; /* CSS height; o JS ajusta o backing store */
    display:block;
  }
  @media (max-width: 720px){
    canvas#investChart{height:360px;}
  }
</style>

<div id="chartOverlay" class="chartOverlay" onclick="closeChart(event)">
  <div class="chartModal" onclick="event.stopPropagation()">
    <div class="chartHead">
      <div>
        <h3>üìà Investimento √ó Valoriza√ß√£o ‚Äî compara√ß√£o 5 anos</h3>
        <p class="subtitle" style="margin-top:6px">
          Usa parcela/entrada do produto (se encontrado) + taxa do produto (ou fallback).
          Mostra valores por ano no gr√°fico.
        </p>
      </div>
      <button class="danger" onclick="closeChart()">Fechar</button>
    </div>

    <div class="chartBody">
      <div class="chartMeta">
        <div class="row">
          <span class="chip" id="chartProdChip">Produto: ‚Äî</span>
          <span class="chip" id="chartRateChip">Taxa: ‚Äî</span>
          <span class="chip" id="chartPayChip">Parcela: ‚Äî</span>
          <span class="chip" id="chartEntryChip">Entrada: ‚Äî</span>
        </div>
        <div class="row">
          <button class="ghost" onclick="redrawChart()">Atualizar gr√°fico</button>
        </div>
      </div>

      <div class="chartCanvasWrap">
        <canvas id="investChart"></canvas>
      </div>

      <p class="muted">
        Observa√ß√£o: se o produto n√£o tiver taxa cadastrada, usa <strong>IGP-M</strong> (se dispon√≠vel) e, se n√£o tiver, fallback <strong>12% a.a.</strong>.
      </p>
    </div>
  </div>
</div>

<script>
/* ===================== PARTE 4 ‚Äî DADOS / REGRAS ===================== */

/* 1) Taxas ‚Äúna mem√≥ria‚Äù por produto:
   - Voc√™ pode ir alimentando aqui depois (sem quebrar nada).
   - Se j√° existir no seu c√≥digo (PARTE 2) uma estrutura parecida, n√£o tem problema: este bloco s√≥ usa se existir.
*/
window.PRODUCT_RATES = window.PRODUCT_RATES || {
  // exemplos (edite quando quiser):
  // "CEDROS JARDINS": { annual: 0.16 }, // 16% a.a.
  // "MORADA BRASIL": { annual: 0.14 }
};

/* 2) Helpers para pegar produto ativo e extrair valores do pr√≥prio "info" do produto */
function getActiveProductSafe(){
  try{
    // pega o que j√° aparece no card "Produto ativo"
    const name = (document.getElementById("prod-name")?.textContent || "").trim();
    const infoLis = Array.from(document.querySelectorAll("#prod-info li")).map(li => (li.textContent||"").trim());
    return { name, info: infoLis };
  }catch(e){
    return { name:"", info:[] };
  }
}

function parseMoneyBRL(s){
  // pega "R$ 753" / "R$ 753,00" / "753" etc
  const m = String(s||"").match(/R\$\s*([0-9\.\s]+)(?:,([0-9]{1,2}))?/i);
  if(m){
    const intPart = (m[1]||"").replace(/\./g,"").replace(/\s/g,"");
    const decPart = (m[2]||"00").padEnd(2,"0").slice(0,2);
    return Number(intPart + "." + decPart);
  }
  // fallback tenta qualquer n√∫mero
  const n = String(s||"").match(/([0-9]{2,})(?:,([0-9]{1,2}))?/);
  if(n){
    const a = (n[1]||"").replace(/\./g,"");
    const b = (n[2]||"00").padEnd(2,"0").slice(0,2);
    return Number(a + "." + b);
  }
  return null;
}

function extractParcelAndEntry(infoLines){
  let parcela = null;
  let entrada = 0;

  for(const line of (infoLines||[])){
    const t = line.toLowerCase();
    if(parcela === null && (t.includes("parcela") || t.includes("parcelas"))){
      const val = parseMoneyBRL(line);
      if(val) parcela = val;
    }
    if(t.includes("entrada")){
      // "Entrada: n√£o" => 0
      if(t.includes("nao") || t.includes("n√£o")) { entrada = 0; continue; }
      const val = parseMoneyBRL(line);
      if(val !== null) entrada = val;
    }
  }

  return { parcela, entrada };
}

function getRateForProduct(productName){
  const byProduct = window.PRODUCT_RATES?.[productName];
  if(byProduct && typeof byProduct.annual === "number" && byProduct.annual > 0) return byProduct.annual;

  // tenta usar IGP-M do painel econ√¥mico (PARTE 3) como fallback
  const igpm = window.ECONOMIC_INDEXES?.igpm?.value;
  if(typeof igpm === "number" && igpm > 0) return igpm / 100;

  // fallback final
  return 0.12; // 12% a.a.
}

/* ===================== PARTE 4 ‚Äî UI / BOT√ÉO ===================== */
function ensureChartButton(){
  // coloca o bot√£o no topo (sem mexer no HTML original)
  const statusLine = document.querySelector(".statusline");
  if(!statusLine) return;

  if(document.getElementById("openChartBtn")) return;

  const btn = document.createElement("button");
  btn.id = "openChartBtn";
  btn.className = "chartBtn";
  btn.type = "button";
  btn.textContent = "üìà Gr√°fico 5 anos";
  btn.onclick = () => openChart();

  // coloca antes do Admin/Sair para ficar organizado
  const admin = document.getElementById("adminBtn");
  if(admin && admin.parentNode === statusLine){
    statusLine.insertBefore(btn, admin);
  }else{
    statusLine.appendChild(btn);
  }
}

function openChart(){
  document.getElementById("chartOverlay")?.classList.add("show");
  redrawChart();
}

function closeChart(ev){
  // se clicar fora, fecha
  if(ev && ev.target && ev.target.id !== "chartOverlay") return;
  document.getElementById("chartOverlay")?.classList.remove("show");
}

/* ===================== PARTE 4 ‚Äî DESENHO DO CANVAS ===================== */
function formatBRL(n){
  try{
    return (Number(n)||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
  }catch(e){
    return "R$ " + (Math.round((Number(n)||0)*100)/100);
  }
}

function fitCanvas(canvas){
  const dpr = window.devicePixelRatio || 1;
  const cssW = canvas.clientWidth;
  const cssH = canvas.clientHeight;
  canvas.width  = Math.round(cssW * dpr);
  canvas.height = Math.round(cssH * dpr);
  const ctx = canvas.getContext("2d");
  ctx.setTransform(dpr,0,0,dpr,0,0);
  return ctx;
}

function drawLine(ctx, x1,y1,x2,y2){
  ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke();
}

function drawCircle(ctx, x,y,r){
  ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill();
}

function redrawChart(){
  const { name, info } = getActiveProductSafe();
  const { parcela, entrada } = extractParcelAndEntry(info);

  const rate = getRateForProduct(name);
  const ratePct = (rate*100);

  // fallback de parcela se n√£o achou no info
  const monthly = (typeof parcela === "number" && parcela > 0) ? parcela : 750;
  const entry   = (typeof entrada === "number" && entrada >= 0) ? entrada : 0;

  // Atualiza chips do modal
  document.getElementById("chartProdChip").textContent  = "Produto: " + (name || "n√£o identificado");
  document.getElementById("chartRateChip").textContent  = "Taxa: " + ratePct.toFixed(2).replace(".",",") + "% a.a.";
  document.getElementById("chartPayChip").textContent   = "Parcela: " + formatBRL(monthly);
  document.getElementById("chartEntryChip").textContent = "Entrada: " + formatBRL(entry);

  // S√©rie 0..5 anos
  const years = [0,1,2,3,4,5];

  // Investimento acumulado (entrada + parcelas)
  const invested = years.map(y => entry + monthly * 12 * y);

  // "Valor projetado" (aplicando valoriza√ß√£o anual sobre o investido acumulado)
  // -> forma simples, est√°vel e did√°tica para o comparativo
  const projected = years.map(y => invested[y] * Math.pow(1+rate, y));

  // Canvas
  const canvas = document.getElementById("investChart");
  if(!canvas) return;
  const ctx = fitCanvas(canvas);

  const W = canvas.clientWidth;
  const H = canvas.clientHeight;

  // Limpa
  ctx.clearRect(0,0,W,H);

  // Layout
  const padL = 64, padR = 22, padT = 18, padB = 54;
  const plotW = W - padL - padR;
  const plotH = H - padT - padB;

  // Escala Y
  const maxY = Math.max(...projected, ...invested) * 1.08;

  const xAt = (i) => padL + (plotW * (i/(years.length-1)));
  const yAt = (val) => padT + plotH - (plotH * (val/maxY));

  // Grid leve (sem cores fixas ‚Äúfortes‚Äù)
  ctx.lineWidth = 1;
  ctx.strokeStyle = "rgba(229,231,235,.95)";
  for(let g=0; g<=4; g++){
    const y = padT + (plotH*(g/4));
    drawLine(ctx, padL, y, padL+plotW, y);
  }

  // Eixos
  ctx.strokeStyle = "rgba(17,24,39,.18)";
  drawLine(ctx, padL, padT, padL, padT+plotH);
  drawLine(ctx, padL, padT+plotH, padL+plotW, padT+plotH);

  // Labels X (anos)
  ctx.fillStyle = "rgba(55,65,81,.92)";
  ctx.font = "700 12px Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial";
  years.forEach((y, i)=>{
    const x = xAt(i);
    ctx.fillText(String(y)+"a", x-8, padT+plotH+28);
  });

  // S√©rie 1: Investido (linha)
  ctx.lineWidth = 3;
  ctx.strokeStyle = "rgba(76,91,212,.85)";
  ctx.beginPath();
  invested.forEach((v,i)=>{
    const x = xAt(i), y = yAt(v);
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();

  // S√©rie 2: Projetado (linha)
  ctx.strokeStyle = "rgba(22,163,74,.82)";
  ctx.beginPath();
  projected.forEach((v,i)=>{
    const x = xAt(i), y = yAt(v);
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();

  // Pontos + n√∫meros (ano a ano)
  const labelFont = "800 11px Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial";
  years.forEach((_, i)=>{
    // Investido
    let x = xAt(i), y = yAt(invested[i]);
    ctx.fillStyle = "rgba(76,91,212,.92)";
    drawCircle(ctx, x, y, 4);
    ctx.font = labelFont;
    ctx.fillText(formatBRL(invested[i]).replace("R$","R$ "), x-18, y+18);

    // Projetado
    x = xAt(i); y = yAt(projected[i]);
    ctx.fillStyle = "rgba(22,163,74,.92)";
    drawCircle(ctx, x, y, 4);
    ctx.font = labelFont;
    ctx.fillText(formatBRL(projected[i]).replace("R$","R$ "), x-18, y-10);
  });

  // Legenda
  const lx = padL, ly = padT + 8;
  ctx.font = "900 12px Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial";
  ctx.fillStyle = "rgba(76,91,212,.92)";
  ctx.fillText("‚óè Investimento acumulado", lx, ly);
  ctx.fillStyle = "rgba(22,163,74,.92)";
  ctx.fillText("‚óè Valor projetado (valoriza√ß√£o)", lx+210, ly);

  // T√≠tulo pequeno dentro do plot
  ctx.fillStyle = "rgba(11,18,32,.75)";
  ctx.font = "900 12px Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial";
  ctx.fillText("Compara√ß√£o em 5 anos (0‚Üí5)", padL, padT+plotH-10);
}

/* Re-render ao redimensionar */
window.addEventListener("resize", ()=>{
  const overlay = document.getElementById("chartOverlay");
  if(overlay && overlay.classList.contains("show")){
    redrawChart();
  }
});

/* Boot */
document.addEventListener("DOMContentLoaded", ()=>{
  ensureChartButton();
});
</script>
<!-- ===================== FIM PARTE 4 ===================== -->
