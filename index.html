<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>COPILOTO PRO ‚Äî Fechamento Imobili√°rio</title>

<style>
/* ================== THEME ================== */
:root{
  --bg:#f5f7fb;
  --panel:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --border:#e5e7eb;

  --primary:#4f46e5;
  --primary-strong:#4338ca;

  --neon:#22c55e;
  --danger:#ef4444;

  --radius:16px;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}

[data-theme="dark"]{
  --bg:#020617;
  --panel:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:#1e293b;
  --shadow:0 12px 40px rgba(0,0,0,.55);
}

/* ================== RESET ================== */
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}

/* ================== HEADER ================== */
header{
  position:sticky;
  top:0;
  z-index:10;
  background:var(--panel);
  border-bottom:1px solid var(--border);
  box-shadow:var(--shadow);
}
.top{
  max-width:1400px;
  margin:auto;
  padding:16px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
}
.brand h1{
  margin:0;
  font-size:20px;
  font-weight:900;
}
.brand span{
  font-size:12px;
  color:var(--muted);
}

/* ================== BUTTONS ================== */
.btn{
  padding:10px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--panel);
  cursor:pointer;
  font-weight:800;
}
.btn-primary{
  background:linear-gradient(180deg,var(--primary),var(--primary-strong));
  color:#fff;
  border:none;
}
.btn-neon{
  background:rgba(34,197,94,.15);
  color:var(--neon);
  border:1px solid rgba(34,197,94,.5);
  box-shadow:0 0 18px rgba(34,197,94,.35);
}
.btn-danger{
  background:rgba(239,68,68,.12);
  color:var(--danger);
  border:1px solid rgba(239,68,68,.4);
}

/* ================== MAIN GRID ================== */
main{
  max-width:1400px;
  margin:auto;
  padding:24px;
}
.grid{
  display:grid;
  grid-template-columns:320px 1fr 420px;
  gap:20px;
}

/* ================== CARD ================== */
.card{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.card header{
  padding:16px;
  border-bottom:1px solid var(--border);
}
.card header h2{
  margin:0;
  font-size:15px;
}
.card header p{
  margin:6px 0 0;
  font-size:12px;
  color:var(--muted);
}
.card .body{
  padding:16px;
}

/* ================== PRODUCT ================== */
.product-name{
  font-size:18px;
  font-weight:900;
}
.product-list{
  margin:14px 0 0;
  padding-left:18px;
}
.product-list li{
  font-size:13px;
  margin:6px 0;
}

/* ================== INPUT ================== */
textarea{
  width:100%;
  min-height:220px;
  padding:14px;
  font-size:14px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  resize:vertical;
}
textarea:focus{
  outline:none;
  border-color:var(--primary);
}

/* ================== RESPONSES ================== */
.response{
  margin-bottom:14px;
}
.response strong{
  font-size:13px;
}
.response p{
  font-size:14px;
  line-height:1.55;
  margin:6px 0 0;
}

/* ================== GRAPH ================== */
.graph-box{
  height:220px;
  border-radius:14px;
  border:1px dashed var(--border);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:13px;
  color:var(--muted);
}

/* ================== MOBILE ================== */
@media(max-width:1100px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body data-theme="light">

<header>
  <div class="top">
    <div class="brand">
      <h1>COPILOTO PRO</h1>
      <span>Fechamento imobili√°rio em tempo real</span>
    </div>

    <div style="display:flex;gap:10px">
      <button class="btn btn-neon" id="btnRates">üìä Taxas</button>
      <button class="btn" id="toggleTheme">üåô / ‚òÄÔ∏è</button>
      <button class="btn btn-danger">Sair</button>
    </div>
  </div>
</header>

<main>
  <div class="grid">

    <!-- PRODUTO -->
    <aside class="card">
      <header>
        <h2>Produto ativo</h2>
        <p>Todas as informa√ß√µes do loteamento</p>
      </header>
      <div class="body">
        <div class="product-name" id="productName">Produto n√£o identificado</div>
        <ul class="product-list" id="productInfo"></ul>
      </div>
    </aside>

    <!-- INPUT -->
    <section class="card">
      <header>
        <h2>Fala do cliente</h2>
        <p>Digite ou use o microfone</p>
      </header>
      <div class="body">
        <textarea id="inputText" placeholder="Digite ou dite o que o cliente falou..."></textarea>
        <div style="display:flex;gap:10px;margin-top:12px">
          <button class="btn btn-primary">üéôÔ∏è Microfone</button>
          <button class="btn btn-danger">Limpar</button>
        </div>
      </div>
    </section>

    <!-- RESPOSTAS + GR√ÅFICO -->
    <section>

      <div class="card">
        <header>
          <h2>Respostas sugeridas</h2>
          <p>Baseadas na obje√ß√£o detectada</p>
        </header>
        <div class="body">
          <div class="response">
            <strong>Leve</strong>
            <p id="r1">‚Äî</p>
          </div>
          <div class="response">
            <strong>M√©dia</strong>
            <p id="r2">‚Äî</p>
          </div>
          <div class="response">
            <strong>Agressiva</strong>
            <p id="r3">‚Äî</p>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:20px">
        <header>
          <h2>Valoriza√ß√£o do investimento</h2>
          <p>Visual para apresenta√ß√£o ao cliente</p>
        </header>
        <div class="body">
          <div class="graph-box">
            Gr√°fico ser√° carregado aqui
          </div>
        </div>
      </div>

    </section>

  </div>
</main>

</body>
</html>
<script>
/* ===================== THEME ===================== */
const themeBtn = document.getElementById("toggleTheme");
const bodyEl = document.body;

const savedTheme = localStorage.getItem("copiloto_theme");
if(savedTheme) bodyEl.setAttribute("data-theme", savedTheme);

themeBtn.onclick = () => {
  const current = bodyEl.getAttribute("data-theme") || "light";
  const next = current === "light" ? "dark" : "light";
  bodyEl.setAttribute("data-theme", next);
  localStorage.setItem("copiloto_theme", next);
};

/* ===================== BASE PRODUTOS ===================== */
const PRODUCTS = [
  {
    name:"CEDROS JARDINS",
    value:150000,
    valorizacao:18,
    info:[
      "Lotes a partir de 200 m¬≤",
      "Parcelas a partir de R$ 753",
      "Sem entrada",
      "Pr√≥ximo ao Posto B√∫falo"
    ]
  },
  {
    name:"MORADA BRASIL",
    value:170000,
    valorizacao:18,
    info:[
      "Parcelas a partir de R$ 713",
      "At√© 240x",
      "Av. Andr√© Maggi"
    ]
  }
];

let activeProduct = null;

/* ===================== ELEMENTOS ===================== */
const productName = document.getElementById("productName");
const productInfo = document.getElementById("productInfo");
const inputText = document.getElementById("inputText");

const r1 = document.getElementById("r1");
const r2 = document.getElementById("r2");
const r3 = document.getElementById("r3");

const ratesBtn = document.getElementById("btnRates");

/* ===================== ECONOMIA (BCB) ===================== */
async function getBCB(code){
  const url = `https://api.bcb.gov.br/dados/serie/bcdata.sgs.${code}/dados/ultimos/12?formato=json`;
  const res = await fetch(url);
  const data = await res.json();
  return data.reduce((a,b)=>a+Number(b.valor),0);
}

async function loadEconomy(){
  try{
    const ipca = await getBCB(433);
    const igpm = await getBCB(189);
    const selic = await getBCB(4189);

    alert(
`üìä ECONOMIA ‚Äì 12 MESES
IPCA: ${ipca.toFixed(2)}%
IGP-M: ${igpm.toFixed(2)}%
SELIC: ${selic.toFixed(2)}%`
    );
  }catch(e){
    alert("Erro ao carregar taxas econ√¥micas");
  }
}

ratesBtn.onclick = loadEconomy;

/* ===================== DETECTAR PRODUTO ===================== */
function detectProduct(text){
  const t = text.toLowerCase();
  return PRODUCTS.find(p => t.includes(p.name.toLowerCase().split(" ")[0]));
}

function showProduct(p){
  activeProduct = p;
  productName.textContent = p.name;
  productInfo.innerHTML = p.info.map(i=>`<li>${i}</li>`).join("");
}

/* ===================== CALCULADORA PERDA ===================== */
function calcLoss(value, rate, months){
  const monthly = rate / 12 / 100;
  return value * Math.pow(1+monthly, months) - value;
}

/* ===================== OBJE√á√ïES ===================== */
function processText(){
  const text = inputText.value.toLowerCase();
  if(!text) return;

  const prod = detectProduct(text);
  if(prod) showProduct(prod);

  if(!activeProduct) return;

  if(text.includes("pensar") || text.includes("depois")){
    const loss6 = calcLoss(activeProduct.value, activeProduct.valorizacao, 6);
    r1.textContent = "Tudo bem analisar. O que voc√™ quer avaliar primeiro?";
    r2.textContent = "S√≥ pra alinhar: o que precisa acontecer pra virar um sim?";
    r3.textContent =
      `Esperar 6 meses pode custar cerca de R$ ${loss6.toFixed(0)} nesse lote. Prefere garantir agora ou pagar mais depois?`;
  }

  if(text.includes("caro")){
    r1.textContent = "Entendo. Quando voc√™ diz caro, √© pela parcela ou pelo valor final?";
    r2.textContent = "Comparando com qual op√ß√£o? Posso te mostrar o melhor encaixe.";
    r3.textContent =
      "O que encarece de verdade √© esperar. Esse tipo de lote valoriza acima da m√©dia.";
  }
}

inputText.addEventListener("input", processText);

/* ===================== GR√ÅFICO SIMPLES ===================== */
const graphBox = document.querySelector(".graph-box");

function renderGraph(){
  if(!activeProduct) return;
  const months = [0,6,12];
  const values = months.map(m =>
    activeProduct.value + calcLoss(activeProduct.value, activeProduct.valorizacao, m)
  );

  graphBox.innerHTML = `
    <div style="width:100%">
      ${months.map((m,i)=>`
        <div style="margin-bottom:6px">
          <strong>${m} meses:</strong> R$ ${values[i].toFixed(0)}
        </div>
      `).join("")}
    </div>
  `;
}

setInterval(renderGraph, 2000);
</script>
