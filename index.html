<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>COPILOTO PRO ‚Äî Assistente Imobili√°rio</title>

<style>
/* ===================== THEME ===================== */
:root{
  --bg:#f5f7fb;
  --panel:#ffffff;
  --text:#0f172a;
  --muted:#64748b;
  --border:#e5e7eb;
  --primary:#4f46e5;
  --neon:#22c55e;
  --danger:#ef4444;
  --radius:16px;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}
[data-theme="dark"]{
  --bg:#020617;
  --panel:#0b1220;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:#1e293b;
  --shadow:0 12px 40px rgba(0,0,0,.55);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}
header{
  position:sticky;top:0;z-index:10;
  background:var(--panel);
  border-bottom:1px solid var(--border);
  box-shadow:var(--shadow);
}
.top{
  max-width:1400px;margin:auto;
  padding:16px 20px;
  display:flex;justify-content:space-between;align-items:center;gap:12px;
}
.brand h1{margin:0;font-size:20px;font-weight:900}
.brand span{font-size:12px;color:var(--muted)}
.actions{display:flex;gap:10px;flex-wrap:wrap}
.btn{
  padding:10px 14px;border-radius:12px;
  border:1px solid var(--border);
  background:var(--panel);cursor:pointer;font-weight:700;
}
.btn-neon{
  background:rgba(34,197,94,.15);
  color:var(--neon);
  border:1px solid rgba(34,197,94,.5);
  box-shadow:0 0 18px rgba(34,197,94,.35);
}
.btn-primary{background:var(--primary);color:#fff;border:none}
.btn-danger{
  background:rgba(239,68,68,.12);
  color:var(--danger);
  border:1px solid rgba(239,68,68,.4);
}
main{max-width:1400px;margin:auto;padding:24px}
.grid{
  display:grid;
  grid-template-columns:300px 1fr;
  gap:20px;
}
.card{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
}
.small{font-size:12px;color:var(--muted)}
input,textarea,select{
  width:100%;padding:10px;
  border-radius:10px;border:1px solid var(--border);
  background:var(--panel);color:var(--text);
}
textarea{min-height:90px}

/* MODAL */
.modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.55);
  display:none;align-items:center;justify-content:center;
  z-index:100;
}
.modal.show{display:flex}
.modal-box{
  width:min(900px,100%);
  max-height:90vh;
  overflow:auto;
  background:var(--panel);
  border-radius:18px;
  padding:20px;
}
.tabs{display:flex;gap:10px;margin-bottom:14px}
.tab{cursor:pointer;font-weight:700}
.tab.active{color:var(--primary)}
.hidden{display:none}
</style>
</head>

<body data-theme="light">

<header>
  <div class="top">
    <div class="brand">
      <h1>COPILOTO PRO</h1>
      <span>Assistente comercial imobili√°rio</span>
    </div>
    <div class="actions">
      <button class="btn btn-neon" id="btnFormalizacao">üìÑ Formaliza√ß√£o</button>
      <button class="btn btn-neon" id="btnAdmin">‚öôÔ∏è Admin</button>
      <button class="btn" id="toggleTheme">üåô / ‚òÄÔ∏è</button>
    </div>
  </div>
</header>

<main>
  <div class="card">
    Sistema pronto. Use o **Admin** para editar produtos, usu√°rios e obje√ß√µes.
  </div>
</main>

<!-- ADMIN -->
<div class="modal" id="adminModal">
  <div class="modal-box">
    <h3>‚öôÔ∏è Admin ‚Äî Base do Sistema</h3>

    <div class="tabs">
      <div class="tab active" data-tab="users">Usu√°rios</div>
      <div class="tab" data-tab="products">Produtos</div>
      <div class="tab" data-tab="objections">Obje√ß√µes</div>
    </div>

    <!-- USERS -->
    <div id="tab-users">
      <textarea id="usersJson"></textarea>
    </div>

    <!-- PRODUCTS -->
    <div id="tab-products" class="hidden">
      <textarea id="productsJson"></textarea>
    </div>

    <!-- OBJECTIONS -->
    <div id="tab-objections" class="hidden">
      <textarea id="objectionsJson"></textarea>
    </div>

    <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn btn-primary" id="btnSave">Salvar</button>
      <button class="btn" id="btnExport">Exportar JSON</button>
      <button class="btn" id="btnReset">Reset padr√£o</button>
      <button class="btn btn-danger" id="btnCloseAdmin">Fechar</button>
    </div>

    <div class="small" id="adminMsg" style="margin-top:10px"></div>
  </div>
</div>

<script>
/* ===================== STORAGE ===================== */
const LS_BASE="copiloto_base_final";
const LS_BACKUP="copiloto_base_backup_final";

/* ===================== BASE ===================== */
const DEFAULT_BASE={
  users:[
    {username:"admin",password:"1234",role:"admin",name:"Administrador"},
    {username:"user",password:"1234",role:"user",name:"Corretor"}
  ],
  products:[],
  objections:[]
};

function loadBase(){
  try{
    const raw=localStorage.getItem(LS_BASE);
    return raw?JSON.parse(raw):structuredClone(DEFAULT_BASE);
  }catch{return structuredClone(DEFAULT_BASE);}
}

function saveBaseSafe(base){
  localStorage.setItem(LS_BACKUP,localStorage.getItem(LS_BASE));
  localStorage.setItem(LS_BASE,JSON.stringify(base,null,2));
}

let BASE=loadBase();

/* ===================== ADMIN ===================== */
const adminModal=document.getElementById("adminModal");
const usersJson=document.getElementById("usersJson");
const productsJson=document.getElementById("productsJson");
const objectionsJson=document.getElementById("objectionsJson");
const adminMsg=document.getElementById("adminMsg");

document.getElementById("btnAdmin").onclick=()=>{
  usersJson.value=JSON.stringify(BASE.users,null,2);
  productsJson.value=JSON.stringify(BASE.products,null,2);
  objectionsJson.value=JSON.stringify(BASE.objections,null,2);
  adminModal.classList.add("show");
};

document.getElementById("btnCloseAdmin").onclick=()=>adminModal.classList.remove("show");

/* Tabs */
document.querySelectorAll(".tab").forEach(t=>{
  t.onclick=()=>{
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    document.querySelectorAll("[id^='tab-']").forEach(x=>x.classList.add("hidden"));
    document.getElementById("tab-"+t.dataset.tab).classList.remove("hidden");
  };
});

/* Save */
document.getElementById("btnSave").onclick=()=>{
  try{
    const newBase={
      users:JSON.parse(usersJson.value),
      products:JSON.parse(productsJson.value),
      objections:JSON.parse(objectionsJson.value)
    };
    if(!newBase.users.length) throw "Precisa de usu√°rios";
    saveBaseSafe(newBase);
    BASE=newBase;
    adminMsg.textContent="‚úÖ Base salva com sucesso";
  }catch(e){
    adminMsg.textContent="‚ùå Erro ao salvar base";
  }
};

/* Export */
document.getElementById("btnExport").onclick=()=>{
  const full=JSON.stringify(BASE,null,2);
  navigator.clipboard.writeText(full);
  adminMsg.textContent="üìã JSON copiado";
};

/* Reset */
document.getElementById("btnReset").onclick=()=>{
  if(!confirm("Resetar base padr√£o?"))return;
  BASE=structuredClone(DEFAULT_BASE);
  saveBaseSafe(BASE);
  adminMsg.textContent="üîÑ Base resetada";
};

/* ===================== FORMALIZA√á√ÉO ===================== */
document.getElementById("btnFormalizacao").onclick=()=>{
  const payload={
    empreendimento:"",
    entrada:"",
    parcela:""
  };
  localStorage.setItem("copiloto_formalizacao_prefill",JSON.stringify(payload));
  location.href="https://lucianabogo333-spec.github.io/formalizacao-proposta/";
};

/* ===================== THEME ===================== */
document.getElementById("toggleTheme").onclick=()=>{
  const cur=document.body.getAttribute("data-theme");
  const next=cur==="dark"?"light":"dark";
  document.body.setAttribute("data-theme",next);
};
</script>

</body>
</html>
