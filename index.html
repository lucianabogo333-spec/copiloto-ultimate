<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>COPILOTO ‚Äî Assistente de Obje√ß√µes em Tempo Real</title>

<style>
:root{
  --bg:#f6f7fb;
  --panel:#ffffff;
  --text:#0b1220;
  --muted:#5b6474;
  --border:#e5e7eb;

  --primary:#4c5bd4;
  --primary2:#3f4bd0;
  --ring: rgba(76,91,212,.22);

  --good:#16a34a;
  --warn:#f59e0b;
  --bad:#ef4444;

  --radius:16px;
  --radius2:22px;
  --tap:48px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color:var(--text);
}

/* HEADER */
header{
  position:sticky;
  top:0;
  z-index:10;
  background:rgba(255,255,255,.9);
  backdrop-filter: blur(10px);
  border-bottom:1px solid var(--border);
}
.topbar{
  max-width:1200px;
  margin:0 auto;
  padding:14px 18px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}
.brand h1{
  margin:0;
  font-size:18px;
  font-weight:900;
}
.brand span{
  font-size:12px;
  color:var(--muted);
  font-weight:600;
}
.statusline{
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}

/* BOT√ïES */
button{
  min-height:var(--tap);
  padding:12px 14px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#fff;
  font-weight:900;
  cursor:pointer;
}
button.primary{
  background:linear-gradient(180deg,var(--primary),var(--primary2));
  color:#fff;
  border:none;
}
button.danger{
  background:rgba(239,68,68,.12);
  border-color:rgba(239,68,68,.25);
  color:#7f1d1d;
}
button.ghost{
  background:rgba(76,91,212,.08);
  border-color:rgba(76,91,212,.25);
  color:#1f2a9a;
}

/* LAYOUT BASE */
main{
  max-width:1200px;
  margin:0 auto;
  padding:18px;
}
.grid{
  display:grid;
  grid-template-columns: 320px 1fr 430px;
  gap:16px;
}

/* CARDS */
.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:var(--radius);
}
.card .head{
  padding:14px;
  border-bottom:1px solid var(--border);
}
.card .body{
  padding:14px;
}

/* LOGIN OVERLAY */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(11,18,32,.6);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:50;
}
.modal{
  width:min(520px,100%);
  background:#fff;
  border-radius:var(--radius2);
  padding:18px;
}
.formGrid{
  display:grid;
  gap:10px;
}
.formGrid.two{
  grid-template-columns:1fr 1fr;
}
input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
}

/* MOBILE */
@media (max-width:980px){
  .grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginOverlay" class="overlay">
  <div class="modal">
    <h2>Entrar no COPILOTO</h2>
    <div class="formGrid two">
      <input id="loginUser" placeholder="Login">
      <input id="loginPass" type="password" placeholder="Senha">
    </div>
    <button class="primary" onclick="doLogin()">Entrar</button>
  </div>
</div>

<header>
  <div class="topbar">
    <div class="brand">
      <h1>COPILOTO</h1>
      <span>Assistente de Obje√ß√µes em Tempo Real</span>
    </div>
    <div class="statusline">
      <button id="adminBtn" class="ghost" style="display:none">‚öôÔ∏è Admin</button>
      <button id="logoutBtn" class="danger" style="display:none">Sair</button>
    </div>
  </div>
</header>
<main>
  <div class="grid">

    <!-- PRODUTO ATIVO -->
    <aside class="card" id="productCard">
      <div class="head">
        <h3>Produto ativo</h3>
        <p class="subtitle">Detectado automaticamente pela fala do cliente</p>
      </div>
      <div class="body">
        <p id="prod-name" class="productName">Produto n√£o identificado</p>
        <ul id="prod-info" class="infoList"></ul>
      </div>
    </aside>

    <!-- INPUT -->
    <section class="card" id="inputCard">
      <div class="head">
        <h3>Caixa de di√°logo</h3>
        <p class="subtitle">Digite exatamente o que o cliente falou</p>
      </div>
      <div class="body">
        <textarea id="input" placeholder="Ex: achei caro, vou pensar melhor..."></textarea>
      </div>
    </section>

    <!-- RESPOSTAS -->
    <section class="responsesGrid" id="responsesWrap">

      <div class="card">
        <div class="head">
          <h4>Quebra Leve</h4>
        </div>
        <div class="body">
          <p id="r1">‚Äî</p>
          <button onclick="copy('r1')">Copiar</button>
        </div>
      </div>

      <div class="card">
        <div class="head">
          <h4>Quebra M√©dia</h4>
        </div>
        <div class="body">
          <p id="r2">‚Äî</p>
          <button onclick="copy('r2')">Copiar</button>
        </div>
      </div>

      <div class="card">
        <div class="head">
          <h4>Quebra Agressiva</h4>
        </div>
        <div class="body">
          <p id="r3">‚Äî</p>
          <button onclick="copy('r3')">Copiar</button>
        </div>
      </div>

    </section>

  </div>
</main>

<!-- ADMIN DRAWER -->
<div id="adminDrawer" class="overlay" style="display:none">
  <div class="modal" style="width:min(900px,100%)">
    <h3>Admin ‚Äî Produtos ‚Ä¢ Obje√ß√µes ‚Ä¢ Usu√°rios</h3>

    <div class="formGrid three" style="margin-bottom:12px">
      <button onclick="setTab('products')">Produtos</button>
      <button onclick="setTab('objections')">Obje√ß√µes</button>
      <button onclick="setTab('users')">Usu√°rios</button>
    </div>

    <!-- PRODUTOS -->
    <div id="viewProducts" style="display:none">
      <h4>Novo / Editar Produto</h4>
      <div class="formGrid">
        <input id="pName" placeholder="Nome do produto">
        <input id="pKeys" placeholder="Palavras-chave (v√≠rgula)">
        <textarea id="pInfo" class="small" placeholder="Informa√ß√µes (1 por linha)"></textarea>
        <button class="primary" onclick="saveProduct()">Salvar produto</button>
      </div>
      <div class="list" id="productsList"></div>
    </div>

    <!-- OBJE√á√ïES -->
    <div id="viewObjections" style="display:none">
      <h4>Novo / Editar Obje√ß√£o</h4>
      <input id="oKeys" placeholder="Palavras-chave (v√≠rgula)">
      <div class="formGrid three">
        <textarea id="oA" class="small" placeholder="Resposta Leve"></textarea>
        <textarea id="oB" class="small" placeholder="Resposta M√©dia"></textarea>
        <textarea id="oC" class="small" placeholder="Resposta Agressiva"></textarea>
      </div>
      <button class="primary" onclick="saveObjection()">Salvar obje√ß√£o</button>
      <div class="list" id="objectionsList"></div>
    </div>

    <!-- USU√ÅRIOS -->
    <div id="viewUsers" style="display:none">
      <h4>Novo / Editar Usu√°rio</h4>
      <div class="formGrid two">
        <input id="uLogin" placeholder="Login">
        <input id="uPass" placeholder="Senha">
      </div>
      <button class="primary" onclick="saveUser()">Salvar usu√°rio</button>
      <div class="list" id="usersList"></div>
    </div>

    <button class="danger" onclick="closeAdmin()">Fechar</button>
  </div>
</div>
<script>
/* ===================== BASE PADR√ÉO ===================== */
const DEFAULT_BASE = {
  products: [
    {
      name: "MORADA BRASIL",
      keys: ["morada"],
      info: ["Parcelas a partir de R$ 713", "Entrada: n√£o"]
    },
    {
      name: "CEDROS JARDINS",
      keys: ["cedros", "b√∫falo"],
      info: ["Lotes 200 m¬≤", "Parcelas a partir de R$ 753", "Entrada: n√£o", "Posto B√∫falo"]
    }
  ],
  objections: [
    {
      keys: ["caro", "pre√ßo alto", "muito caro"],
      a: "Entendo. Quando voc√™ diz caro, √© pelo valor total ou pela parcela?",
      b: "Comparando com qual op√ß√£o? Dependendo disso, d√° pra ajustar bem.",
      c: "Se eu ajustar pra caber no seu bolso, voc√™ decide agora?"
    },
    {
      keys: ["vou pensar", "analisar", "ver depois"],
      a: "Perfeito, analisar √© o certo. O que voc√™ quer avaliar primeiro?",
      b: "Pra sua an√°lise n√£o virar s√≥ deixar pra depois, o que falta pra virar um sim?",
      c: "Se nada mudar, sua tend√™ncia √© avan√ßar ou n√£o?"
    }
  ],
  users: [
    { login: "vendedor", pass: "1234" }
  ]
};

let base = JSON.parse(JSON.stringify(DEFAULT_BASE));
let currentUser = null;

/* ===================== LOGIN ===================== */
function doLogin(){
  const u = loginUser.value.trim();
  const p = loginPass.value.trim();

  if(u === "edson" && p === "2026"){
    currentUser = { login:"edson", role:"admin" };
  } else {
    const found = base.users.find(x => x.login === u && x.pass === p);
    if(!found){
      alert("Login inv√°lido");
      return;
    }
    currentUser = { login: found.login, role:"user" };
  }

  loginOverlay.style.display = "none";
  logoutBtn.style.display = "inline-flex";
  adminBtn.style.display = currentUser.role === "admin" ? "inline-flex" : "none";
}

/* ===================== LOGOUT ===================== */
function logout(){
  location.reload();
}

/* ===================== ADMIN ===================== */
function openAdmin(){
  if(currentUser?.role !== "admin") return;
  adminDrawer.style.display = "flex";
  setTab("products");
  renderAll();
}
function closeAdmin(){
  adminDrawer.style.display = "none";
}
adminBtn.onclick = openAdmin;

/* ===================== TABS ===================== */
function setTab(tab){
  viewProducts.style.display = tab === "products" ? "block" : "none";
  viewObjections.style.display = tab === "objections" ? "block" : "none";
  viewUsers.style.display = tab === "users" ? "block" : "none";
}

/* ===================== PRODUTOS ===================== */
let editingProduct = null;

function saveProduct(){
  const obj = {
    name: pName.value.trim(),
    keys: pKeys.value.split(",").map(s=>s.trim()).filter(Boolean),
    info: pInfo.value.split("\n").map(s=>s.trim()).filter(Boolean)
  };

  if(!obj.name){ alert("Informe o nome do produto"); return; }

  if(editingProduct === null){
    base.products.push(obj);
  } else {
    base.products[editingProduct] = obj;
  }

  editingProduct = null;
  renderProducts();
}

function editProduct(i){
  const p = base.products[i];
  editingProduct = i;
  pName.value = p.name;
  pKeys.value = p.keys.join(", ");
  pInfo.value = p.info.join("\n");
}

function removeProduct(i){
  if(!confirm("Remover este produto?")) return;
  base.products.splice(i,1);
  renderProducts();
}

function renderProducts(){
  productsList.innerHTML = "";
  base.products.forEach((p,i)=>{
    productsList.innerHTML += `
      <div class="item">
        <div>
          <strong>${p.name}</strong>
          <div class="muted">${p.info.join(" ‚Ä¢ ")}</div>
        </div>
        <div>
          <button onclick="editProduct(${i})">Editar</button>
          <button onclick="removeProduct(${i})">Remover</button>
        </div>
      </div>
    `;
  });
}

/* ===================== OBJE√á√ïES ===================== */
let editingObjection = null;

function saveObjection(){
  const obj = {
    keys: oKeys.value.split(",").map(s=>s.trim()).filter(Boolean),
    a: oA.value.trim(),
    b: oB.value.trim(),
    c: oC.value.trim()
  };

  if(obj.keys.length === 0){ alert("Informe palavras-chave"); return; }

  if(editingObjection === null){
    base.objections.push(obj);
  } else {
    base.objections[editingObjection] = obj;
  }

  editingObjection = null;
  renderObjections();
}

function editObjection(i){
  const o = base.objections[i];
  editingObjection = i;
  oKeys.value = o.keys.join(", ");
  oA.value = o.a;
  oB.value = o.b;
  oC.value = o.c;
}

function removeObjection(i){
  if(!confirm("Remover esta obje√ß√£o?")) return;
  base.objections.splice(i,1);
  renderObjections();
}

function renderObjections(){
  objectionsList.innerHTML = "";
  base.objections.forEach((o,i)=>{
    objectionsList.innerHTML += `
      <div class="item">
        <div>
          <strong>${o.keys.join(", ")}</strong>
          <div class="muted">${o.a}</div>
        </div>
        <div>
          <button onclick="editObjection(${i})">Editar</button>
          <button onclick="removeObjection(${i})">Remover</button>
        </div>
      </div>
    `;
  });
}

/* ===================== USU√ÅRIOS ===================== */
let editingUser = null;

function saveUser(){
  const obj = { login: uLogin.value.trim(), pass: uPass.value.trim() };
  if(!obj.login || !obj.pass){ alert("Preencha login e senha"); return; }

  if(editingUser === null){
    base.users.push(obj);
  } else {
    base.users[editingUser] = obj;
  }

  editingUser = null;
  renderUsers();
}

function editUser(i){
  const u = base.users[i];
  editingUser = i;
  uLogin.value = u.login;
  uPass.value = u.pass;
}

function removeUser(i){
  if(!confirm("Remover este usu√°rio?")) return;
  base.users.splice(i,1);
  renderUsers();
}

function renderUsers(){
  usersList.innerHTML = "";
  base.users.forEach((u,i)=>{
    usersList.innerHTML += `
      <div class="item">
        <div><strong>${u.login}</strong></div>
        <div>
          <button onclick="editUser(${i})">Editar</button>
          <button onclick="removeUser(${i})">Remover</button>
        </div>
      </div>
    `;
  });
}

function renderAll(){
  renderProducts();
  renderObjections();
  renderUsers();
}

/* ===================== CORE ‚Äî DETEC√á√ÉO ===================== */
function normalize(t){
  return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");
}

input.addEventListener("input", ()=>{
  const text = normalize(input.value);

  const product = base.products.find(p =>
    p.keys.some(k => text.includes(normalize(k)))
  );

  if(product){
    prod-name.textContent = product.name;
    prod-info.innerHTML = product.info.map(i=>`<li>${i}</li>`).join("");
  }

  const objection = base.objections.find(o =>
    o.keys.some(k => text.includes(normalize(k)))
  );

  if(objection){
    r1.textContent = objection.a;
    r2.textContent = objection.b;
    r3.textContent = objection.c;
  }
});

/* ===================== COPIAR ===================== */
function copy(id){
  navigator.clipboard.writeText(
    document.getElementById(id).innerText
  );
}
</script>
<script>
/* ===================== BOT√ÉO FORMALIZA√á√ÉO ===================== */
const btnFormalizar = document.createElement("button");
btnFormalizar.className = "primary";
btnFormalizar.textContent = "üìÑ Formalizar proposta";
btnFormalizar.onclick = () => {
  window.open(
    "https://lucianabogo333-spec.github.io/formalizacao-proposta/",
    "_blank"
  );
};

document.querySelector(".toolbar .btnRow")?.appendChild(btnFormalizar);

/* ===================== CALCULADORA DE PROCRASTINA√á√ÉO ===================== */
const calcCard = document.createElement("div");
calcCard.className = "card";
calcCard.innerHTML = `
  <div class="head">
    <div class="title">
      <h3>Calculadora de Procrastina√ß√£o</h3>
      <p class="subtitle">Quanto custa adiar a decis√£o</p>
    </div>
  </div>
  <div class="body formGrid two">
    <div>
      <label>Valor do lote (R$)</label>
      <input id="calcValor" type="number" placeholder="Ex: 120000">
    </div>
    <div>
      <label>Valoriza√ß√£o anual (%)</label>
      <input id="calcTaxa" type="number" placeholder="Ex: 12">
    </div>
    <div class="row" style="grid-column:1/-1; justify-content:flex-end">
      <button onclick="calcularProcrastinacao()">Calcular</button>
    </div>
    <div id="calcResultado" class="success" style="display:none"></div>
  </div>
`;

document.querySelector("main").appendChild(calcCard);

function calcularProcrastinacao(){
  const valor = Number(document.getElementById("calcValor").value);
  const taxa = Number(document.getElementById("calcTaxa").value) / 100;

  if(!valor || !taxa){
    alert("Preencha todos os campos");
    return;
  }

  const mensal = valor * (taxa / 12);
  const anual = valor * taxa;

  const el = document.getElementById("calcResultado");
  el.style.display = "block";
  el.innerHTML = `
    ‚è≥ <strong>Custo de esperar:</strong><br>
    ‚Ä¢ M√™s: <strong>R$ ${mensal.toFixed(2)}</strong><br>
    ‚Ä¢ Ano: <strong>R$ ${anual.toFixed(2)}</strong>
  `;
}

/* ===================== REL√ìGIO ECON√îMICO ===================== */
const econ = document.createElement("div");
econ.className = "pill";
econ.style.position = "fixed";
econ.style.bottom = "16px";
econ.style.left = "16px";
econ.style.zIndex = "50";
econ.innerHTML = `
  <strong>SELIC:</strong> 10,50% |
  <strong>IPCA:</strong> 4,5% |
  <strong>IGPM:</strong> 3,8%
`;
document.body.appendChild(econ);

/* ===================== GR√ÅFICO INVESTIMENTO X VALORIZA√á√ÉO ===================== */
const graphCard = document.createElement("div");
graphCard.className = "card";
graphCard.innerHTML = `
  <div class="head">
    <div class="title">
      <h3>Investimento x Valoriza√ß√£o (5 anos)</h3>
    </div>
  </div>
  <div class="body">
    <canvas id="grafico" height="220"></canvas>
  </div>
`;
document.querySelector("main").appendChild(graphCard);

const ctx = document.getElementById("grafico").getContext("2d");

function drawChart(){
  const base = 100;
  const rate = 0.12;
  ctx.clearRect(0,0,500,300);

  ctx.beginPath();
  ctx.moveTo(40,200);

  for(let i=1;i<=5;i++){
    const val = base * Math.pow(1+rate,i);
    ctx.lineTo(40 + i*70, 200 - val);
    ctx.fillText(`R$ ${(val*1000).toFixed(0)}`, 20 + i*70, 200 - val - 5);
  }

  ctx.strokeStyle = "#4c5bd4";
  ctx.lineWidth = 3;
  ctx.stroke();

  ctx.fillText("Ano 0", 35, 220);
  for(let i=1;i<=5;i++){
    ctx.fillText(`Ano ${i}`, 30 + i*70, 220);
  }
}

drawChart();
</script>

</body>
</html>
